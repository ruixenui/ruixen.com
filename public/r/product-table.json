{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "product-table",
  "type": "registry:ui",
  "title": "Product Table",
  "description": "Full-featured data table with spring-sorting, pagination pills, search filtering, column visibility, and audio feedback.",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "registry/ruixenui/product-table.tsx",
      "content": "\"use client\";\n\nimport { useState, useRef, useMemo, useCallback } from \"react\";\nimport { motion, AnimatePresence } from \"motion/react\";\n\n/**\n * Product Table — Rauno Freiberg craft.\n *\n * Glass container with spring-sorting, spring-pagination pills,\n * search filtering with staggered row entrance, and column visibility.\n * Sort arrows rotate with spring. Pagination indicator slides.\n * Audio tick on every interaction.\n */\n\n/* ── Audio ── */\n\nlet _a: AudioContext | null = null;\nlet _b: AudioBuffer | null = null;\nfunction getCtx(): AudioContext {\n  if (!_a) _a = new (window.AudioContext || (window as unknown as { webkitAudioContext: typeof AudioContext }).webkitAudioContext)();\n  if (_a.state === \"suspended\") _a.resume();\n  return _a;\n}\nfunction getBuf(ac: AudioContext): AudioBuffer {\n  if (_b && _b.sampleRate === ac.sampleRate) return _b;\n  const len = Math.floor(ac.sampleRate * 0.003);\n  const buf = ac.createBuffer(1, len, ac.sampleRate);\n  const ch = buf.getChannelData(0);\n  for (let i = 0; i < len; i++) ch[i] = (Math.random() * 2 - 1) * (1 - i / len) ** 4;\n  _b = buf; return buf;\n}\nfunction tick(ref: React.MutableRefObject<number>) {\n  const now = performance.now();\n  if (now - ref.current < 25) return;\n  ref.current = now;\n  try { const ac = getCtx(); const s = ac.createBufferSource(); const g = ac.createGain(); s.buffer = getBuf(ac); g.gain.value = 0.06; s.connect(g).connect(ac.destination); s.start(); } catch { /* silent */ }\n}\n\n/* ── Types ── */\n\nexport type Product = {\n  id: string;\n  name: string;\n  category: string;\n  price: number;\n  stock: number;\n  status: \"In Stock\" | \"Low Stock\" | \"Out of Stock\";\n};\n\nexport interface ProductTableProps {\n  data?: Product[];\n  title?: string;\n  pageSize?: number;\n  sound?: boolean;\n}\n\n/* ── Defaults ── */\n\nconst DEFAULTS: Product[] = [\n  { id: \"1\", name: \"Wireless Earbuds\", category: \"Audio\", price: 79.99, stock: 142, status: \"In Stock\" },\n  { id: \"2\", name: \"USB-C Hub\", category: \"Accessories\", price: 45.00, stock: 8, status: \"Low Stock\" },\n  { id: \"3\", name: \"Mechanical Keyboard\", category: \"Input\", price: 129.99, stock: 56, status: \"In Stock\" },\n  { id: \"4\", name: \"4K Webcam\", category: \"Video\", price: 199.00, stock: 0, status: \"Out of Stock\" },\n  { id: \"5\", name: \"Desk Lamp\", category: \"Lighting\", price: 34.50, stock: 220, status: \"In Stock\" },\n  { id: \"6\", name: \"Monitor Stand\", category: \"Accessories\", price: 89.00, stock: 3, status: \"Low Stock\" },\n  { id: \"7\", name: \"Noise Cancelling Headphones\", category: \"Audio\", price: 249.99, stock: 31, status: \"In Stock\" },\n  { id: \"8\", name: \"Trackpad\", category: \"Input\", price: 129.00, stock: 0, status: \"Out of Stock\" },\n  { id: \"9\", name: \"Thunderbolt Cable\", category: \"Accessories\", price: 29.99, stock: 450, status: \"In Stock\" },\n  { id: \"10\", name: \"Studio Monitor\", category: \"Audio\", price: 349.00, stock: 12, status: \"In Stock\" },\n  { id: \"11\", name: \"Portable SSD\", category: \"Storage\", price: 109.99, stock: 67, status: \"In Stock\" },\n  { id: \"12\", name: \"Ergonomic Mouse\", category: \"Input\", price: 69.00, stock: 5, status: \"Low Stock\" },\n  { id: \"13\", name: \"Ring Light\", category: \"Lighting\", price: 54.99, stock: 0, status: \"Out of Stock\" },\n  { id: \"14\", name: \"Docking Station\", category: \"Accessories\", price: 179.00, stock: 18, status: \"In Stock\" },\n  { id: \"15\", name: \"Condenser Mic\", category: \"Audio\", price: 159.99, stock: 25, status: \"In Stock\" },\n];\n\n/* ── Column defs ── */\n\ntype ColKey = \"name\" | \"category\" | \"price\" | \"stock\" | \"status\";\n\ninterface ColDef {\n  key: ColKey;\n  label: string;\n  align?: \"left\" | \"right\";\n  sortable?: boolean;\n}\n\nconst COLUMNS: ColDef[] = [\n  { key: \"name\", label: \"Name\", sortable: true },\n  { key: \"category\", label: \"Category\", sortable: true },\n  { key: \"price\", label: \"Price\", align: \"right\", sortable: true },\n  { key: \"stock\", label: \"Stock\", align: \"right\", sortable: true },\n  { key: \"status\", label: \"Status\", sortable: true },\n];\n\n/* ── CSS ── */\n\nconst CSS = `.pt{--t-bg:rgba(255,255,255,.72);--t-border:rgba(0,0,0,.06);--t-shadow:0 0 0 .5px rgba(0,0,0,.04),0 2px 4px rgba(0,0,0,.04),0 8px 24px rgba(0,0,0,.06);--t-ink:0,0,0;--t-ok:#34C759;--t-warn:#FF9F0A;--t-err:#FF3B30}.dark .pt,[data-theme=\"dark\"] .pt{--t-bg:rgba(30,30,32,.82);--t-border:rgba(255,255,255,.06);--t-shadow:0 0 0 .5px rgba(255,255,255,.04),0 2px 4px rgba(0,0,0,.2),0 8px 24px rgba(0,0,0,.3);--t-ink:255,255,255;--t-ok:#30D158;--t-warn:#FFD60A;--t-err:#FF453A}.pt-row{transition:background .1s}.pt-row:hover{background:rgba(var(--t-ink),.03)}.pt-inp{background:rgba(var(--t-ink),.03);border:1px solid rgba(var(--t-ink),.08);border-radius:8px;padding:7px 12px;font-size:12px;font-weight:420;color:rgba(var(--t-ink),.8);outline:none;transition:border-color .15s;width:180px}.pt-inp:focus{border-color:rgba(var(--t-ink),.2)}.pt-inp::placeholder{color:rgba(var(--t-ink),.25)}`;\n\nconst TH: React.CSSProperties = {\n  padding: \"10px 16px\", fontSize: 11, fontWeight: 520,\n  color: \"rgba(var(--t-ink),.4)\", letterSpacing: \"0.04em\",\n  textTransform: \"uppercase\", whiteSpace: \"nowrap\",\n  borderBottom: \"1px solid var(--t-border)\",\n  userSelect: \"none\",\n};\n\nconst TD: React.CSSProperties = {\n  padding: \"10px 16px\", fontSize: 13, fontWeight: 420,\n  color: \"rgba(var(--t-ink),.7)\",\n  borderBottom: \"1px solid rgba(var(--t-ink),.03)\", whiteSpace: \"nowrap\",\n};\n\n/* ── Icons ── */\n\nfunction IcoSort({ active, desc }: { active: boolean; desc: boolean }) {\n  return (\n    <motion.svg\n      width=\"10\" height=\"10\" viewBox=\"0 0 10 10\"\n      fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.4\" strokeLinecap=\"round\"\n      animate={{ rotate: active && desc ? 180 : 0, opacity: active ? 1 : 0.3 }}\n      transition={{ type: \"spring\", stiffness: 400, damping: 28 }}\n      style={{ flexShrink: 0 }}\n    >\n      <path d=\"M2 6l3-3 3 3\" />\n    </motion.svg>\n  );\n}\n\n/* ── Component ── */\n\nexport function ProductTable({\n  data = DEFAULTS,\n  title = \"Products\",\n  pageSize = 8,\n  sound = true,\n}: ProductTableProps) {\n  const lastSound = useRef(0);\n  const [query, setQuery] = useState(\"\");\n  const [sortKey, setSortKey] = useState<ColKey | null>(null);\n  const [sortDesc, setSortDesc] = useState(false);\n  const [page, setPage] = useState(0);\n  const [colVis, setColVis] = useState<Record<ColKey, boolean>>(() =>\n    Object.fromEntries(COLUMNS.map((c) => [c.key, true])) as Record<ColKey, boolean>,\n  );\n  const [showColMenu, setShowColMenu] = useState(false);\n\n  /* Filter */\n  const filtered = useMemo(() => {\n    if (!query) return data;\n    const q = query.toLowerCase();\n    return data.filter((p) =>\n      p.name.toLowerCase().includes(q) ||\n      p.category.toLowerCase().includes(q) ||\n      p.status.toLowerCase().includes(q),\n    );\n  }, [data, query]);\n\n  /* Sort */\n  const sorted = useMemo(() => {\n    if (!sortKey) return filtered;\n    return [...filtered].sort((a, b) => {\n      const av = a[sortKey];\n      const bv = b[sortKey];\n      if (typeof av === \"number\" && typeof bv === \"number\") return sortDesc ? bv - av : av - bv;\n      return sortDesc ? String(bv).localeCompare(String(av)) : String(av).localeCompare(String(bv));\n    });\n  }, [filtered, sortKey, sortDesc]);\n\n  /* Paginate */\n  const totalPages = Math.max(1, Math.ceil(sorted.length / pageSize));\n  const safePage = Math.min(page, totalPages - 1);\n  const paged = sorted.slice(safePage * pageSize, (safePage + 1) * pageSize);\n  const start = safePage * pageSize + 1;\n  const end = Math.min((safePage + 1) * pageSize, sorted.length);\n\n  /* Visible columns */\n  const visCols = useMemo(() => COLUMNS.filter((c) => colVis[c.key]), [colVis]);\n\n  /* Handlers */\n  const handleSort = useCallback((key: ColKey) => {\n    if (sortKey === key) {\n      setSortDesc((d) => !d);\n    } else {\n      setSortKey(key);\n      setSortDesc(false);\n    }\n    setPage(0);\n    if (sound) tick(lastSound);\n  }, [sortKey, sound]);\n\n  const handlePage = useCallback((p: number) => {\n    setPage(p);\n    if (sound) tick(lastSound);\n  }, [sound]);\n\n  const toggleCol = useCallback((key: ColKey) => {\n    setColVis((prev) => ({ ...prev, [key]: !prev[key] }));\n    if (sound) tick(lastSound);\n  }, [sound]);\n\n  /* Status color */\n  const statusColor = (s: string) =>\n    s === \"In Stock\" ? \"var(--t-ok)\" : s === \"Low Stock\" ? \"var(--t-warn)\" : \"var(--t-err)\";\n\n  /* Cell renderer */\n  const renderCell = (col: ColDef, row: Product) => {\n    switch (col.key) {\n      case \"name\":\n        return <span style={{ fontWeight: 500, color: \"rgba(var(--t-ink),.85)\" }}>{row.name}</span>;\n      case \"price\":\n        return <span style={{ fontVariantNumeric: \"tabular-nums\" }}>${row.price.toFixed(2)}</span>;\n      case \"stock\":\n        return <span style={{ fontVariantNumeric: \"tabular-nums\" }}>{row.stock.toLocaleString()}</span>;\n      case \"status\":\n        return (\n          <span style={{ display: \"inline-flex\", alignItems: \"center\", gap: 6 }}>\n            <span style={{ width: 6, height: 6, borderRadius: \"50%\", background: statusColor(row.status) }} />\n            <span style={{ fontSize: 12, color: \"rgba(var(--t-ink),.5)\" }}>{row.status}</span>\n          </span>\n        );\n      default:\n        return String(row[col.key]);\n    }\n  };\n\n  return (\n    <div className=\"pt\" style={{\n      width: \"100%\", maxWidth: 760,\n      background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n      boxShadow: \"var(--t-shadow)\", borderRadius: 14,\n      backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n      overflow: \"hidden\",\n    }}>\n      <style dangerouslySetInnerHTML={{ __html: CSS }} />\n\n      {/* Header bar */}\n      <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", padding: \"12px 16px\", gap: 8 }}>\n        <span style={{ fontSize: 13, fontWeight: 560, color: \"rgba(var(--t-ink),.85)\", letterSpacing: \"-0.01em\" }}>\n          {title}\n        </span>\n        <div style={{ display: \"flex\", gap: 6, alignItems: \"center\" }}>\n          <input\n            className=\"pt-inp\"\n            placeholder=\"Search products…\"\n            value={query}\n            onChange={(e) => { setQuery(e.target.value); setPage(0); }}\n          />\n          <div style={{ position: \"relative\" }}>\n            <button\n              onClick={() => setShowColMenu(!showColMenu)}\n              style={{\n                border: \"none\", background: \"rgba(var(--t-ink),.04)\", padding: \"5px 10px\",\n                borderRadius: 6, fontSize: 11, fontWeight: 500, color: \"rgba(var(--t-ink),.5)\",\n                cursor: \"pointer\",\n              }}\n            >\n              Columns\n            </button>\n            <AnimatePresence>\n              {showColMenu && (\n                <motion.div\n                  initial={{ opacity: 0, y: -4, scale: 0.96 }}\n                  animate={{ opacity: 1, y: 0, scale: 1 }}\n                  exit={{ opacity: 0, y: -4, scale: 0.96 }}\n                  transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\n                  style={{\n                    position: \"absolute\", right: 0, top: \"calc(100% + 4px)\", zIndex: 20,\n                    background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n                    boxShadow: \"var(--t-shadow)\", borderRadius: 10, padding: \"6px 0\",\n                    minWidth: 140, backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n                  }}\n                >\n                  {COLUMNS.map((col) => {\n                    const vis = colVis[col.key];\n                    return (\n                      <button\n                        key={col.key}\n                        onClick={() => toggleCol(col.key)}\n                        style={{\n                          display: \"flex\", alignItems: \"center\", gap: 8, width: \"100%\",\n                          padding: \"6px 12px\", border: \"none\", background: \"none\",\n                          cursor: \"pointer\", fontSize: 12, fontWeight: 450,\n                          color: vis ? \"rgba(var(--t-ink),.7)\" : \"rgba(var(--t-ink),.3)\",\n                          textAlign: \"left\",\n                        }}\n                      >\n                        <span style={{\n                          width: 14, height: 14, borderRadius: 4,\n                          border: `1.5px solid rgba(var(--t-ink),${vis ? \".3\" : \".12\"})`,\n                          display: \"flex\", alignItems: \"center\", justifyContent: \"center\",\n                        }}>\n                          {vis && (\n                            <svg width=\"8\" height=\"8\" viewBox=\"0 0 8 8\"><path d=\"M1.5 4L3 5.5L6.5 2\" stroke=\"currentColor\" strokeWidth=\"1.2\" fill=\"none\" strokeLinecap=\"round\" /></svg>\n                          )}\n                        </span>\n                        {col.label}\n                      </button>\n                    );\n                  })}\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </div>\n        </div>\n      </div>\n\n      {/* Click-away */}\n      {showColMenu && <div onClick={() => setShowColMenu(false)} style={{ position: \"fixed\", inset: 0, zIndex: 15 }} />}\n\n      {/* Table */}\n      <div style={{ overflowX: \"auto\" }}>\n        <table style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              {visCols.map((col) => (\n                <th\n                  key={col.key}\n                  onClick={() => col.sortable && handleSort(col.key)}\n                  style={{\n                    ...TH,\n                    textAlign: col.align || \"left\",\n                    cursor: col.sortable ? \"pointer\" : \"default\",\n                    color: sortKey === col.key ? \"rgba(var(--t-ink),.7)\" : TH.color,\n                    transition: \"color .12s\",\n                  }}\n                >\n                  <div style={{ display: \"inline-flex\", alignItems: \"center\", gap: 4 }}>\n                    {col.label}\n                    {col.sortable && <IcoSort active={sortKey === col.key} desc={sortKey === col.key && sortDesc} />}\n                  </div>\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            <AnimatePresence mode=\"popLayout\">\n              {paged.map((row, i) => (\n                <motion.tr\n                  key={row.id}\n                  layout\n                  className=\"pt-row\"\n                  initial={{ opacity: 0, y: -6 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, y: 6 }}\n                  transition={{ type: \"spring\", stiffness: 400, damping: 30, delay: i * 0.02 }}\n                >\n                  {visCols.map((col) => (\n                    <td key={col.key} style={{ ...TD, textAlign: col.align || \"left\" }}>\n                      {renderCell(col, row)}\n                    </td>\n                  ))}\n                </motion.tr>\n              ))}\n            </AnimatePresence>\n            {paged.length === 0 && (\n              <tr>\n                <td colSpan={visCols.length} style={{ ...TD, textAlign: \"center\", padding: \"24px 16px\", color: \"rgba(var(--t-ink),.3)\" }}>\n                  No products found.\n                </td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      </div>\n\n      {/* Footer / Pagination */}\n      <div style={{\n        display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\",\n        padding: \"10px 16px\", borderTop: \"1px solid var(--t-border)\",\n      }}>\n        <span style={{ fontSize: 11, fontWeight: 450, color: \"rgba(var(--t-ink),.35)\", fontVariantNumeric: \"tabular-nums\" }}>\n          {sorted.length > 0 ? `${start}–${end} of ${sorted.length}` : \"0 results\"}\n        </span>\n        {totalPages > 1 && (\n          <div style={{ display: \"flex\", gap: 2, alignItems: \"center\" }}>\n            {Array.from({ length: totalPages }, (_, i) => (\n              <button\n                key={i}\n                onClick={() => handlePage(i)}\n                style={{\n                  position: \"relative\",\n                  width: 24, height: 24, borderRadius: 6,\n                  border: \"none\", background: \"none\", cursor: \"pointer\",\n                  fontSize: 11, fontWeight: 500,\n                  color: i === safePage ? \"rgba(var(--t-ink),.88)\" : \"rgba(var(--t-ink),.35)\",\n                  display: \"flex\", alignItems: \"center\", justifyContent: \"center\",\n                  fontVariantNumeric: \"tabular-nums\",\n                  zIndex: 1,\n                }}\n              >\n                {i === safePage && (\n                  <motion.div\n                    layoutId=\"pt-page\"\n                    style={{\n                      position: \"absolute\", inset: 0, borderRadius: 6,\n                      background: \"rgba(var(--t-ink),.08)\",\n                    }}\n                    transition={{ type: \"spring\", stiffness: 500, damping: 35 }}\n                  />\n                )}\n                <span style={{ position: \"relative\", zIndex: 1 }}>{i + 1}</span>\n              </button>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default ProductTable;\n",
      "type": "registry:ui",
      "target": "components/ruixen/product-table.tsx"
    }
  ]
}
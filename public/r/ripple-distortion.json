{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "ripple-distortion",
  "type": "registry:ui",
  "title": "Ripple Distortion",
  "description": "An interactive image distortion effect with mouse-driven ripples using Three.js.",
  "dependencies": [
    "three"
  ],
  "files": [
    {
      "path": "registry/ruixenui/ripple-distortion.tsx",
      "content": "\"use client\";\n\nimport React, { useRef, useEffect } from \"react\";\nimport * as THREE from \"three\";\n\ninterface RippleDistortionProps {\n  imageSrc: string;\n  frequency?: number;\n  amplitude?: number;\n  speed?: number;\n  className?: string;\n}\n\nconst vertexShader = `\nuniform float time;\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n`;\n\nconst fragmentShader = `\nuniform float time;\nuniform sampler2D uTexture;\nuniform vec2 uMouse;\nuniform float frequency;\nuniform float amplitude;\nuniform float speed;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec2 uv = vUv;\n\n  // Distance from mouse\n  float dist = distance(uv, uMouse);\n\n  // Ripple effect\n  float ripple = sin(dist * frequency - time * speed) * amplitude / (dist + 0.1);\n\n  vec2 distortedUv = uv + normalize(uv - uMouse) * ripple;\n  gl_FragColor = texture2D(uTexture, distortedUv);\n}\n`;\n\nconst RippleDistortion: React.FC<RippleDistortionProps> = ({\n  imageSrc,\n  frequency = 30.0,\n  amplitude = 0.02,\n  speed = 5.0,\n  className = \"\",\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const rendererRef = useRef<THREE.WebGLRenderer | null>(null);\n  const sceneRef = useRef<THREE.Scene | null>(null);\n  const cameraRef = useRef<THREE.OrthographicCamera | null>(null);\n  const animationIdRef = useRef<number | null>(null);\n\n  useEffect(() => {\n    if (!containerRef.current) return;\n    const container = containerRef.current;\n\n    const scene = new THREE.Scene();\n    sceneRef.current = scene;\n\n    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\n    renderer.setClearColor(0x000000, 0);\n    container.innerHTML = \"\";\n    container.appendChild(renderer.domElement);\n    rendererRef.current = renderer;\n\n    const camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0.1, 10);\n    camera.position.z = 1;\n    cameraRef.current = camera;\n\n    const uniforms = {\n      time: { value: 0 },\n      uTexture: { value: null as THREE.Texture | null },\n      uMouse: { value: new THREE.Vector2(0.5, 0.5) },\n      frequency: { value: frequency },\n      amplitude: { value: amplitude },\n      speed: { value: speed },\n    };\n\n    const loader = new THREE.TextureLoader();\n    loader.load(imageSrc, (texture: THREE.Texture) => {\n      texture.minFilter = THREE.LinearFilter;\n      texture.magFilter = THREE.LinearFilter;\n      uniforms.uTexture.value = texture;\n      resize();\n    });\n\n    const material = new THREE.ShaderMaterial({\n      vertexShader,\n      fragmentShader,\n      uniforms,\n      transparent: true,\n    });\n\n    const geometry = new THREE.PlaneGeometry(2, 2);\n    const mesh = new THREE.Mesh(geometry, material);\n    scene.add(mesh);\n\n    const resize = () => {\n      const rect = container.getBoundingClientRect();\n      const width = rect.width;\n      const height = rect.height;\n      if (width === 0 || height === 0) return;\n\n      renderer.setSize(width, height);\n    };\n\n    window.addEventListener(\"resize\", resize);\n    resize();\n\n    const handleMouseMove = (e: MouseEvent) => {\n      const rect = container.getBoundingClientRect();\n      const x = (e.clientX - rect.left) / rect.width;\n      const y = 1.0 - (e.clientY - rect.top) / rect.height;\n      uniforms.uMouse.value.set(x, y);\n    };\n\n    container.addEventListener(\"mousemove\", handleMouseMove);\n\n    const animate = () => {\n      animationIdRef.current = requestAnimationFrame(animate);\n      uniforms.time.value += 0.02;\n      renderer.render(scene, camera);\n    };\n\n    animate();\n\n    return () => {\n      if (animationIdRef.current) cancelAnimationFrame(animationIdRef.current);\n      window.removeEventListener(\"resize\", resize);\n      container.removeEventListener(\"mousemove\", handleMouseMove);\n      renderer.dispose();\n      geometry.dispose();\n      material.dispose();\n      if (uniforms.uTexture.value) uniforms.uTexture.value.dispose();\n    };\n  }, [imageSrc, frequency, amplitude, speed]);\n\n  return (\n    <div\n      ref={containerRef}\n      className={`relative overflow-hidden ${className}`}\n      style={{ width: \"100%\", height: \"100%\" }}\n    />\n  );\n};\n\nexport default RippleDistortion;\n",
      "type": "registry:ui",
      "target": "components/ruixen/ripple-distortion.tsx"
    }
  ]
}
{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "flexi-filter-table",
  "type": "registry:ui",
  "title": "Flexi Filter Table",
  "description": "Glass table with multi-filter bar: search, spring-animated status pills, location dropdown, balance range. Row selection with spring transitions.",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "registry/ruixenui/flexi-filter-table.tsx",
      "content": "\"use client\";\n\nimport { useState, useRef, useMemo, useCallback } from \"react\";\nimport { motion, AnimatePresence } from \"motion/react\";\n\n/**\n * Flexi Filter Table — Rauno Freiberg craft.\n *\n * Glass table with multi-filter bar: search, status pills, location dropdown,\n * balance range. Row selection via custom checkboxes. Filtered rows\n * spring in/out. Status dots. Audio tick on filter changes.\n */\n\n/* ── Audio ── */\n\nlet _a: AudioContext | null = null;\nlet _b: AudioBuffer | null = null;\nfunction getCtx(): AudioContext {\n  if (!_a) _a = new (window.AudioContext || (window as unknown as { webkitAudioContext: typeof AudioContext }).webkitAudioContext)();\n  if (_a.state === \"suspended\") _a.resume();\n  return _a;\n}\nfunction getBuf(ac: AudioContext): AudioBuffer {\n  if (_b && _b.sampleRate === ac.sampleRate) return _b;\n  const len = Math.floor(ac.sampleRate * 0.003);\n  const buf = ac.createBuffer(1, len, ac.sampleRate);\n  const ch = buf.getChannelData(0);\n  for (let i = 0; i < len; i++) ch[i] = (Math.random() * 2 - 1) * (1 - i / len) ** 4;\n  _b = buf; return buf;\n}\nfunction tick(ref: React.MutableRefObject<number>) {\n  const now = performance.now();\n  if (now - ref.current < 25) return;\n  ref.current = now;\n  try { const ac = getCtx(); const s = ac.createBufferSource(); const g = ac.createGain(); s.buffer = getBuf(ac); g.gain.value = 0.06; s.connect(g).connect(ac.destination); s.start(); } catch { /* silent */ }\n}\n\n/* ── Types ── */\n\nexport interface FlexiRow {\n  id: number;\n  name: string;\n  email: string;\n  location: string;\n  status: string;\n  balance: number;\n}\n\ninterface FlexiFilterTableProps {\n  data?: FlexiRow[];\n  statuses?: string[];\n  locations?: string[];\n  sound?: boolean;\n}\n\n/* ── Defaults ── */\n\nconst DEFAULTS: FlexiRow[] = [\n  { id: 1, name: \"Alex Thompson\", email: \"alex.t@company.com\", location: \"San Francisco\", status: \"Active\", balance: 1250 },\n  { id: 2, name: \"Sarah Chen\", email: \"sarah.c@company.com\", location: \"Singapore\", status: \"Active\", balance: 600 },\n  { id: 3, name: \"James Wilson\", email: \"j.wilson@company.com\", location: \"London\", status: \"Inactive\", balance: 650 },\n  { id: 4, name: \"Maria Garcia\", email: \"m.garcia@company.com\", location: \"Madrid\", status: \"Active\", balance: 0 },\n  { id: 5, name: \"David Kim\", email: \"d.kim@company.com\", location: \"Seoul\", status: \"Active\", balance: -1000 },\n];\n\nconst DEFAULT_STATUSES = [\"Active\", \"Inactive\"];\nconst DEFAULT_LOCATIONS = [\"San Francisco\", \"Singapore\", \"London\", \"Madrid\", \"Seoul\"];\n\n/* ── CSS ── */\n\nconst CSS = `.fft{--t-bg:rgba(255,255,255,.72);--t-border:rgba(0,0,0,.06);--t-shadow:0 0 0 .5px rgba(0,0,0,.04),0 2px 4px rgba(0,0,0,.04),0 8px 24px rgba(0,0,0,.06);--t-ink:0,0,0;--t-ok:#34C759;--t-dim:#FF3B30}.dark .fft,[data-theme=\"dark\"] .fft{--t-bg:rgba(30,30,32,.82);--t-border:rgba(255,255,255,.06);--t-shadow:0 0 0 .5px rgba(255,255,255,.04),0 2px 4px rgba(0,0,0,.2),0 8px 24px rgba(0,0,0,.3);--t-ink:255,255,255;--t-ok:#30D158;--t-dim:#FF453A}.fft-row{transition:background .1s}.fft-row:hover{background:rgba(var(--t-ink),.03)}.fft-inp{background:rgba(var(--t-ink),.03);border:1px solid rgba(var(--t-ink),.08);border-radius:8px;padding:7px 12px;font-size:12px;font-weight:420;color:rgba(var(--t-ink),.8);outline:none;transition:border-color .15s}.fft-inp:focus{border-color:rgba(var(--t-ink),.2)}.fft-inp::placeholder{color:rgba(var(--t-ink),.25)}`;\n\nconst TH: React.CSSProperties = {\n  padding: \"10px 16px\", fontSize: 11, fontWeight: 520,\n  color: \"rgba(var(--t-ink),.4)\", letterSpacing: \"0.04em\",\n  textTransform: \"uppercase\", textAlign: \"left\", whiteSpace: \"nowrap\",\n  borderBottom: \"1px solid var(--t-border)\",\n};\n\nconst TD: React.CSSProperties = {\n  padding: \"10px 16px\", fontSize: 13, fontWeight: 420,\n  color: \"rgba(var(--t-ink),.7)\",\n  borderBottom: \"1px solid rgba(var(--t-ink),.03)\", whiteSpace: \"nowrap\",\n};\n\n/* ── Component ── */\n\nexport function FlexiFilterTable({\n  data = DEFAULTS,\n  statuses = DEFAULT_STATUSES,\n  locations = DEFAULT_LOCATIONS,\n  sound = true,\n}: FlexiFilterTableProps) {\n  const [selected, setSelected] = useState<Set<number>>(new Set());\n  const [search, setSearch] = useState(\"\");\n  const [activeStatus, setActiveStatus] = useState(\"All\");\n  const [locOpen, setLocOpen] = useState(false);\n  const [activeLoc, setActiveLoc] = useState(\"All\");\n  const [minBal, setMinBal] = useState(\"\");\n  const [maxBal, setMaxBal] = useState(\"\");\n  const lastSound = useRef(0);\n\n  const filtered = useMemo(() => {\n    return data.filter((item) => {\n      if (activeStatus !== \"All\" && item.status !== activeStatus) return false;\n      if (activeLoc !== \"All\" && item.location !== activeLoc) return false;\n      if (search && !`${item.name} ${item.email}`.toLowerCase().includes(search.toLowerCase())) return false;\n      if (minBal && item.balance < Number(minBal)) return false;\n      if (maxBal && item.balance > Number(maxBal)) return false;\n      return true;\n    });\n  }, [data, search, activeStatus, activeLoc, minBal, maxBal]);\n\n  const toggleRow = useCallback((id: number) => {\n    setSelected((prev) => {\n      const next = new Set(prev);\n      if (next.has(id)) next.delete(id); else next.add(id);\n      return next;\n    });\n  }, []);\n\n  const toggleAll = useCallback(() => {\n    setSelected((prev) => prev.size === filtered.length ? new Set() : new Set(filtered.map((r) => r.id)));\n  }, [filtered]);\n\n  const totalBal = filtered.reduce((s, r) => s + r.balance, 0);\n  const statusColors: Record<string, string> = { Active: \"var(--t-ok)\", Inactive: \"var(--t-dim)\" };\n\n  return (\n    <div className=\"fft\" style={{\n      width: \"100%\", maxWidth: 780,\n      background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n      boxShadow: \"var(--t-shadow)\", borderRadius: 14,\n      backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n      overflow: \"hidden\",\n    }}>\n      <style dangerouslySetInnerHTML={{ __html: CSS }} />\n\n      {/* Header */}\n      <div style={{ padding: \"12px 16px 0\", fontSize: 13, fontWeight: 560, color: \"rgba(var(--t-ink),.85)\", letterSpacing: \"-0.01em\" }}>\n        Team\n      </div>\n\n      {/* Filters */}\n      <div style={{ padding: \"10px 16px\", display: \"flex\", flexWrap: \"wrap\", gap: 8, alignItems: \"center\" }}>\n        {/* Search */}\n        <input\n          className=\"fft-inp\"\n          placeholder=\"Search name or email...\"\n          value={search}\n          onChange={(e) => setSearch(e.target.value)}\n          style={{ width: 180 }}\n        />\n\n        {/* Status pills */}\n        <div style={{ display: \"flex\", gap: 3, position: \"relative\" }}>\n          {[\"All\", ...statuses].map((s) => (\n            <button\n              key={s}\n              onClick={() => { setActiveStatus(s); if (sound) tick(lastSound); }}\n              style={{\n                position: \"relative\", border: \"none\", background: \"none\",\n                padding: \"5px 10px\", borderRadius: 6, fontSize: 11, fontWeight: 500,\n                cursor: \"pointer\", zIndex: 1,\n                color: activeStatus === s ? \"rgba(var(--t-ink),.85)\" : \"rgba(var(--t-ink),.35)\",\n                transition: \"color .15s\",\n              }}\n            >\n              {activeStatus === s && (\n                <motion.div\n                  layoutId=\"fft-status\"\n                  style={{ position: \"absolute\", inset: 0, borderRadius: 6, background: \"rgba(var(--t-ink),.06)\" }}\n                  transition={{ type: \"spring\", stiffness: 500, damping: 35 }}\n                />\n              )}\n              <span style={{ position: \"relative\", zIndex: 1 }}>{s}</span>\n            </button>\n          ))}\n        </div>\n\n        {/* Location dropdown */}\n        <div style={{ position: \"relative\" }}>\n          <button\n            onClick={() => setLocOpen(!locOpen)}\n            style={{\n              border: \"1px solid rgba(var(--t-ink),.08)\", background: \"rgba(var(--t-ink),.03)\",\n              padding: \"5px 10px\", borderRadius: 8, fontSize: 11, fontWeight: 500,\n              color: activeLoc === \"All\" ? \"rgba(var(--t-ink),.4)\" : \"rgba(var(--t-ink),.7)\",\n              cursor: \"pointer\", display: \"flex\", alignItems: \"center\", gap: 4,\n            }}\n          >\n            {activeLoc === \"All\" ? \"Location\" : activeLoc}\n            <svg width=\"8\" height=\"8\" viewBox=\"0 0 8 8\"><path d=\"M2 3L4 5L6 3\" stroke=\"currentColor\" strokeWidth=\"1.2\" fill=\"none\" strokeLinecap=\"round\" /></svg>\n          </button>\n          <AnimatePresence>\n            {locOpen && (\n              <motion.div\n                initial={{ opacity: 0, y: -4, scale: 0.96 }}\n                animate={{ opacity: 1, y: 0, scale: 1 }}\n                exit={{ opacity: 0, y: -4, scale: 0.96 }}\n                transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\n                style={{\n                  position: \"absolute\", left: 0, top: \"calc(100% + 4px)\", zIndex: 20,\n                  background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n                  boxShadow: \"var(--t-shadow)\", borderRadius: 8, padding: \"4px 0\",\n                  minWidth: 140, backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n                }}\n              >\n                {[\"All\", ...locations].map((loc) => (\n                  <button\n                    key={loc}\n                    onClick={() => { setActiveLoc(loc); setLocOpen(false); if (sound) tick(lastSound); }}\n                    style={{\n                      display: \"block\", width: \"100%\", padding: \"6px 12px\",\n                      border: \"none\", background: activeLoc === loc ? \"rgba(var(--t-ink),.04)\" : \"none\",\n                      cursor: \"pointer\", fontSize: 12, fontWeight: activeLoc === loc ? 500 : 420,\n                      color: activeLoc === loc ? \"rgba(var(--t-ink),.8)\" : \"rgba(var(--t-ink),.5)\",\n                      textAlign: \"left\",\n                    }}\n                  >\n                    {loc}\n                  </button>\n                ))}\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </div>\n\n        {/* Balance range */}\n        <div style={{ display: \"flex\", gap: 4, alignItems: \"center\" }}>\n          <input\n            className=\"fft-inp\"\n            type=\"number\"\n            placeholder=\"Min $\"\n            value={minBal}\n            onChange={(e) => setMinBal(e.target.value)}\n            style={{ width: 72 }}\n          />\n          <span style={{ fontSize: 11, color: \"rgba(var(--t-ink),.2)\" }}>–</span>\n          <input\n            className=\"fft-inp\"\n            type=\"number\"\n            placeholder=\"Max $\"\n            value={maxBal}\n            onChange={(e) => setMaxBal(e.target.value)}\n            style={{ width: 72 }}\n          />\n        </div>\n      </div>\n\n      {/* Click-away for location */}\n      {locOpen && <div onClick={() => setLocOpen(false)} style={{ position: \"fixed\", inset: 0, zIndex: 15 }} />}\n\n      {/* Table */}\n      <table style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\n        <thead>\n          <tr>\n            <th style={{ ...TH, width: 40, textAlign: \"center\", cursor: \"pointer\" }} onClick={toggleAll}>\n              <span style={{\n                display: \"inline-flex\", width: 16, height: 16, borderRadius: 4,\n                border: `1.5px solid rgba(var(--t-ink),${selected.size === filtered.length && filtered.length > 0 ? \".5\" : \".15\"})`,\n                background: selected.size === filtered.length && filtered.length > 0 ? \"rgba(var(--t-ink),.08)\" : \"none\",\n                alignItems: \"center\", justifyContent: \"center\",\n              }}>\n                {selected.size === filtered.length && filtered.length > 0 && (\n                  <svg width=\"8\" height=\"8\" viewBox=\"0 0 8 8\"><path d=\"M1.5 4L3 5.5L6.5 2\" stroke=\"rgba(var(--t-ink),.6)\" strokeWidth=\"1.2\" fill=\"none\" strokeLinecap=\"round\" /></svg>\n                )}\n              </span>\n            </th>\n            <th style={TH}>Name</th>\n            <th style={TH}>Email</th>\n            <th style={TH}>Location</th>\n            <th style={TH}>Status</th>\n            <th style={{ ...TH, textAlign: \"right\" }}>Balance</th>\n          </tr>\n        </thead>\n        <tbody>\n          <AnimatePresence mode=\"popLayout\">\n            {filtered.map((row) => {\n              const isSel = selected.has(row.id);\n              return (\n                <motion.tr\n                  key={row.id}\n                  layout\n                  initial={{ opacity: 0, y: -6 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, y: -6 }}\n                  transition={{ type: \"spring\", stiffness: 400, damping: 30 }}\n                  className=\"fft-row\"\n                  style={{ background: isSel ? \"rgba(var(--t-ink),.03)\" : undefined }}\n                >\n                  <td style={{ ...TD, textAlign: \"center\", cursor: \"pointer\" }} onClick={() => toggleRow(row.id)}>\n                    <span style={{\n                      display: \"inline-flex\", width: 16, height: 16, borderRadius: 4,\n                      border: `1.5px solid rgba(var(--t-ink),${isSel ? \".5\" : \".15\"})`,\n                      background: isSel ? \"rgba(var(--t-ink),.08)\" : \"none\",\n                      alignItems: \"center\", justifyContent: \"center\",\n                    }}>\n                      {isSel && (\n                        <svg width=\"8\" height=\"8\" viewBox=\"0 0 8 8\"><path d=\"M1.5 4L3 5.5L6.5 2\" stroke=\"rgba(var(--t-ink),.6)\" strokeWidth=\"1.2\" fill=\"none\" strokeLinecap=\"round\" /></svg>\n                      )}\n                    </span>\n                  </td>\n                  <td style={{ ...TD, fontWeight: 500, color: \"rgba(var(--t-ink),.85)\" }}>{row.name}</td>\n                  <td style={TD}>{row.email}</td>\n                  <td style={TD}>{row.location}</td>\n                  <td style={TD}>\n                    <span style={{ display: \"inline-flex\", alignItems: \"center\", gap: 6 }}>\n                      <span style={{ width: 6, height: 6, borderRadius: \"50%\", background: statusColors[row.status] || \"rgba(var(--t-ink),.2)\" }} />\n                      <span style={{ fontSize: 12, color: \"rgba(var(--t-ink),.5)\" }}>{row.status}</span>\n                    </span>\n                  </td>\n                  <td style={{\n                    ...TD, textAlign: \"right\", fontVariantNumeric: \"tabular-nums\",\n                    color: row.balance < 0 ? \"var(--t-dim)\" : TD.color,\n                  }}>\n                    ${row.balance.toLocaleString()}\n                  </td>\n                </motion.tr>\n              );\n            })}\n          </AnimatePresence>\n        </tbody>\n      </table>\n\n      {/* Footer */}\n      <div style={{\n        display: \"flex\", justifyContent: \"space-between\", padding: \"10px 16px\",\n        borderTop: \"1px solid var(--t-border)\",\n      }}>\n        <span style={{ fontSize: 11, fontWeight: 450, color: \"rgba(var(--t-ink),.35)\" }}>\n          {selected.size > 0 ? `${selected.size} selected` : `${filtered.length} users`}\n        </span>\n        <span style={{ fontSize: 12, fontWeight: 520, color: \"rgba(var(--t-ink),.65)\", fontVariantNumeric: \"tabular-nums\" }}>\n          Total: ${totalBal.toLocaleString()}\n        </span>\n      </div>\n    </div>\n  );\n}\n\nexport default FlexiFilterTable;\n",
      "type": "registry:ui",
      "target": "components/ruixen/flexi-filter-table.tsx"
    }
  ]
}
{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "three-dwall-calendar",
  "type": "registry:ui",
  "title": "Three D Wall Calendar",
  "description": "Interactive 3D wall-style calendar with tilt/drag controls, event management, and shadcn calendar for seamless date selection.",
  "dependencies": [
    "date-fns",
    "lucide-react",
    "uuid"
  ],
  "registryDependencies": [
    "card",
    "button",
    "popover",
    "hover-card",
    "calendar",
    "dialog",
    "label"
  ],
  "files": [
    {
      "path": "registry/ruixenui/three-dwall-calendar.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverTrigger,\n  PopoverContent,\n} from \"@/components/ui/popover\";\nimport {\n  HoverCard,\n  HoverCardTrigger,\n  HoverCardContent,\n} from \"@/components/ui/hover-card\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Trash2 } from \"lucide-react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport {\n  startOfMonth,\n  endOfMonth,\n  eachDayOfInterval,\n  format,\n  parseISO,\n  getDay,\n} from \"date-fns\";\n\nexport type CalendarEvent = {\n  id: string;\n  title: string;\n  date: string; // ISO string\n};\n\ninterface ThreeDWallCalendarProps {\n  events?: CalendarEvent[];\n  onAddEvent?: (e: CalendarEvent) => void;\n  onRemoveEvent?: (id: string) => void;\n  panelWidth?: number;\n  panelHeight?: number;\n  columns?: number;\n}\n\nexport function ThreeDWallCalendar({\n  events = [],\n  onAddEvent,\n  onRemoveEvent,\n  panelWidth = 160,\n  panelHeight = 120,\n  columns = 7,\n}: ThreeDWallCalendarProps) {\n  const [dateRef, setDateRef] = React.useState<Date>(new Date());\n\n  // For adding new event\n  const [selectedDate, setSelectedDate] = React.useState<Date | undefined>(\n    undefined,\n  );\n  const [eventTitle, setEventTitle] = React.useState(\"\");\n  const [isDialogOpen, setIsDialogOpen] = React.useState(false);\n\n  const wallRef = React.useRef<HTMLDivElement | null>(null);\n\n  // 3D tilt\n  const [tiltX, setTiltX] = React.useState(18);\n  const [tiltY, setTiltY] = React.useState(0);\n  const isDragging = React.useRef(false);\n  const dragStart = React.useRef<{ x: number; y: number } | null>(null);\n\n  // Get all days of the month\n  const monthStart = startOfMonth(dateRef);\n  const monthEnd = endOfMonth(dateRef);\n  const daysInMonth = eachDayOfInterval({ start: monthStart, end: monthEnd });\n\n  // Leading blanks (Sunday = 0)\n  const startingWeekday = getDay(monthStart);\n  const leadingBlanks = Array.from({ length: startingWeekday }, () => null);\n\n  // Always force 6 rows → 42 cells total\n  const allCells = [...leadingBlanks, ...daysInMonth];\n  const totalCellsNeeded = 42; // 6 × 7\n  const trailingBlanksNeeded = Math.max(0, totalCellsNeeded - allCells.length);\n  const trailingBlanks = Array.from(\n    { length: trailingBlanksNeeded },\n    () => null,\n  );\n\n  const paddedCells = [...allCells, ...trailingBlanks];\n\n  // Fixed 6 rows for consistent height & visibility\n  const rowCount = 6;\n  const wallCenterRow = (rowCount - 1) / 2; // 2.5\n\n  const eventsForDay = (d: Date | null) => {\n    if (!d) return [];\n    return events.filter(\n      (ev) =>\n        format(parseISO(ev.date), \"yyyy-MM-dd\") === format(d, \"yyyy-MM-dd\"),\n    );\n  };\n\n  // Add event\n  const handleAddEvent = () => {\n    if (!eventTitle.trim() || !selectedDate) return;\n\n    onAddEvent?.({\n      id: uuidv4(),\n      title: eventTitle.trim(),\n      date: selectedDate.toISOString(),\n    });\n\n    setEventTitle(\"\");\n    setSelectedDate(undefined);\n    setIsDialogOpen(false);\n  };\n\n  // Wheel & drag tilt handlers (with safer limits)\n  const onWheel = (e: React.WheelEvent) => {\n    setTiltX((t) => Math.max(5, Math.min(40, t + e.deltaY * 0.02)));\n    setTiltY((t) => Math.max(-45, Math.min(45, t + e.deltaX * 0.05)));\n  };\n\n  const onPointerDown = (e: React.PointerEvent) => {\n    isDragging.current = true;\n    dragStart.current = { x: e.clientX, y: e.clientY };\n    (e.currentTarget as Element).setPointerCapture(e.pointerId);\n  };\n\n  const onPointerMove = (e: React.PointerEvent) => {\n    if (!isDragging.current || !dragStart.current) return;\n    const dx = e.clientX - dragStart.current.x;\n    const dy = e.clientY - dragStart.current.y;\n    setTiltY((t) => Math.max(-60, Math.min(60, t + dx * 0.1)));\n    setTiltX((t) => Math.max(5, Math.min(45, t - dy * 0.1)));\n    dragStart.current = { x: e.clientX, y: e.clientY };\n  };\n\n  const onPointerUp = () => {\n    isDragging.current = false;\n    dragStart.current = null;\n  };\n\n  const gap = 12;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Month navigation */}\n      <div className=\"flex gap-4 items-center justify-center\">\n        <Button\n          variant=\"outline\"\n          onClick={() =>\n            setDateRef((d) => new Date(d.getFullYear(), d.getMonth() - 1, 1))\n          }\n        >\n          Prev Month\n        </Button>\n        <div className=\"text-xl font-semibold\">\n          {format(dateRef, \"MMMM yyyy\")}\n        </div>\n        <Button\n          variant=\"outline\"\n          onClick={() =>\n            setDateRef((d) => new Date(d.getFullYear(), d.getMonth() + 1, 1))\n          }\n        >\n          Next Month\n        </Button>\n      </div>\n\n      {/* Interactive Calendar for adding events */}\n      <div className=\"flex justify-center flex-wrap gap-4\">\n        <Popover>\n          <PopoverTrigger asChild>\n            <Button variant=\"outline\">\n              {selectedDate\n                ? format(selectedDate, \"PPP\")\n                : \"Pick a date to add event\"}\n            </Button>\n          </PopoverTrigger>\n          <PopoverContent className=\"w-auto p-0\" align=\"center\">\n            <Calendar\n              mode=\"single\"\n              selected={selectedDate}\n              onSelect={setSelectedDate}\n              disabled={(date) =>\n                date > new Date() || date < new Date(\"1900-01-01\")\n              }\n              initialFocus\n            />\n          </PopoverContent>\n        </Popover>\n\n        <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n          <DialogTrigger asChild>\n            <Button\n              disabled={!selectedDate}\n              onClick={() => selectedDate && setIsDialogOpen(true)}\n            >\n              Add Event\n            </Button>\n          </DialogTrigger>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>\n                Add Event on {selectedDate && format(selectedDate, \"PPP\")}\n              </DialogTitle>\n            </DialogHeader>\n            <div className=\"grid gap-4 py-4\">\n              <div className=\"grid gap-2\">\n                <Label htmlFor=\"title\">Event Title</Label>\n                <Input\n                  id=\"title\"\n                  value={eventTitle}\n                  onChange={(e) => setEventTitle(e.target.value)}\n                  placeholder=\"Meeting, Birthday...\"\n                  autoFocus\n                />\n              </div>\n            </div>\n            <div className=\"flex justify-end gap-3\">\n              <Button variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\n                Cancel\n              </Button>\n              <Button onClick={handleAddEvent}>Save Event</Button>\n            </div>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Wall container */}\n      <div\n        ref={wallRef}\n        onWheel={onWheel}\n        onPointerDown={onPointerDown}\n        onPointerMove={onPointerMove}\n        onPointerUp={onPointerUp}\n        onPointerCancel={onPointerUp}\n        className=\"w-full \"\n        style={{ perspective: 1200 }}\n      >\n        <div\n          className=\"inline-block\"\n          style={{\n            width: columns * (panelWidth + gap),\n            marginLeft: \"200px\",\n            transformStyle: \"preserve-3d\",\n            transform: `rotateX(${tiltX}deg) rotateY(${tiltY}deg)`,\n            transition: isDragging.current ? \"none\" : \"transform 120ms linear\",\n            minWidth: \"fit-content\",\n          }}\n        >\n          <div\n            className=\"relative\"\n            style={{\n              display: \"grid\",\n              gridTemplateColumns: `repeat(${columns}, ${panelWidth}px)`,\n              gridAutoRows: `${panelHeight}px`,\n              gap: `${gap}px`,\n              padding: gap,\n              transformStyle: \"preserve-3d\",\n            }}\n          >\n            {paddedCells.map((day, idx) => {\n              const row = Math.floor(idx / columns);\n              const rowOffset = row - wallCenterRow;\n              const z = Math.max(-80, 40 - Math.abs(rowOffset) * 20);\n              const dayEvents = eventsForDay(day);\n\n              // Blank cells (leading + trailing)\n              if (day === null) {\n                return (\n                  <div\n                    key={`blank-${idx}`}\n                    className=\"relative\"\n                    style={{\n                      transform: `translateZ(${z}px)`,\n                      zIndex: Math.round(100 - Math.abs(rowOffset)),\n                    }}\n                  >\n                    <Card className=\"h-full bg-transparent border-dashed border-muted opacity-30 cursor-default\">\n                      <CardContent className=\"p-3 h-full\" />\n                    </Card>\n                  </div>\n                );\n              }\n\n              // Real day cells\n              return (\n                <div\n                  key={day.toISOString()}\n                  className=\"relative\"\n                  style={{\n                    transform: `translateZ(${z}px)`,\n                    zIndex: Math.round(100 - Math.abs(rowOffset)),\n                  }}\n                >\n                  <Card className=\"h-full overflow-visible shadow-lg\">\n                    <CardContent className=\"p-3 h-full flex flex-col\">\n                      <div className=\"flex justify-between items-start\">\n                        <div className=\"text-sm font-semibold\">\n                          {format(day, \"d\")}\n                        </div>\n                        <div className=\"text-xs text-muted-foreground\">\n                          {format(day, \"EEE\")}\n                        </div>\n                      </div>\n\n                      <div className=\"mt-2 flex-1 relative\">\n                        {dayEvents.map((ev, i) => {\n                          const left = 8 + ((i * 34) % (panelWidth - 40));\n                          const top =\n                            8 + Math.floor((i * 34) / (panelWidth - 40)) * 28;\n\n                          return (\n                            <Popover key={ev.id}>\n                              <PopoverTrigger asChild>\n                                <HoverCard>\n                                  <HoverCardTrigger asChild>\n                                    <div\n                                      className=\"absolute w-7 h-7 rounded-full bg-blue-500 dark:bg-blue-600 flex items-center justify-center text-white text-[10px] cursor-pointer shadow-md\"\n                                      style={{\n                                        left,\n                                        top,\n                                        transform: \"translateZ(20px)\",\n                                      }}\n                                    >\n                                      •\n                                    </div>\n                                  </HoverCardTrigger>\n                                  <HoverCardContent className=\"text-xs\">\n                                    {ev.title}\n                                  </HoverCardContent>\n                                </HoverCard>\n                              </PopoverTrigger>\n                              <PopoverContent className=\"w-64\">\n                                <Card>\n                                  <CardContent className=\"p-3 flex justify-between items-start\">\n                                    <div>\n                                      <p className=\"font-medium\">{ev.title}</p>\n                                      <p className=\"text-xs text-muted-foreground mt-1\">\n                                        {format(parseISO(ev.date), \"PPP\")}\n                                      </p>\n                                    </div>\n                                    {onRemoveEvent && (\n                                      <Button\n                                        variant=\"ghost\"\n                                        size=\"icon\"\n                                        className=\"h-7 w-7\"\n                                        onClick={() => onRemoveEvent(ev.id)}\n                                      >\n                                        <Trash2 className=\"h-4 w-4 text-red-500\" />\n                                      </Button>\n                                    )}\n                                  </CardContent>\n                                </Card>\n                              </PopoverContent>\n                            </Popover>\n                          );\n                        })}\n                      </div>\n\n                      <div className=\"mt-auto text-xs text-muted-foreground\">\n                        {dayEvents.length} event\n                        {dayEvents.length !== 1 ? \"s\" : \"\"}\n                      </div>\n                    </CardContent>\n                  </Card>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n",
      "type": "registry:ui",
      "target": "components/ruixen/three-dwall-calendar.tsx"
    }
  ]
}
{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "glass-player",
  "type": "registry:ui",
  "title": "Glass Player",
  "description": "iOS 26 liquid-glass Now Playing widget with playback controls, progress scrubbing, equalizer visualization, and multi-track support.",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "registry/ruixenui/glass-player.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport { motion, AnimatePresence } from \"motion/react\";\n\n/* ── sound ─────────────────────────────────────────────── */\nlet _a: AudioContext, _b: AudioBuffer;\nconst tick = () => {\n  if (typeof window === \"undefined\") return;\n  if (!_a) {\n    _a = new AudioContext();\n    _b = _a.createBuffer(1, (_a.sampleRate * 0.003) | 0, _a.sampleRate);\n    const d = _b.getChannelData(0);\n    for (let i = 0; i < d.length; i++)\n      d[i] = (Math.random() * 2 - 1) * (1 - i / d.length) ** 4;\n  }\n  const s = _a.createBufferSource();\n  s.buffer = _b;\n  const g = _a.createGain();\n  g.gain.value = 0.08;\n  s.connect(g).connect(_a.destination);\n  s.start();\n};\n\n/* ── theme ─────────────────────────────────────────────── */\n/*  Light: frosted-white panels, soft outer shadows         */\n/*  Dark : white-tint glass, inner glow                     */\nconst PLAYER_CSS = `\n.gp{\n  --gp-glass:linear-gradient(180deg,rgba(255,255,255,0.78),rgba(255,255,255,0.62));\n  --gp-border:rgba(0,0,0,0.06);\n  --gp-shadow:0 0 1px rgba(0,0,0,0.04),0 2px 8px rgba(0,0,0,0.04),inset 0 1px 0 rgba(255,255,255,0.8);\n  --gp-dim:rgba(0,0,0,0.35);\n  --gp-mid:rgba(0,0,0,0.5);\n  --gp-hi:rgba(0,0,0,0.88);\n  --gp-track:rgba(0,0,0,0.08);\n  --gp-fill:rgba(0,0,0,0.55);\n  --gp-knob:#fff;\n  --gp-knob-border:rgba(0,0,0,0.08);\n  --gp-knob-shadow:0 1px 3px rgba(0,0,0,0.15);\n  --gp-art-shadow:0 4px 12px rgba(0,0,0,0.08);\n  --gp-active:rgba(0,0,0,0.06)\n}\n.dark .gp,[data-theme=\"dark\"] .gp{\n  --gp-glass:linear-gradient(180deg,rgba(255,255,255,0.05),rgba(255,255,255,0.02));\n  --gp-border:rgba(255,255,255,0.07);\n  --gp-shadow:0 1px 3px rgba(0,0,0,0.08),inset 0 1px 0 rgba(255,255,255,0.04);\n  --gp-dim:rgba(255,255,255,0.28);\n  --gp-mid:rgba(255,255,255,0.5);\n  --gp-hi:rgba(255,255,255,0.88);\n  --gp-track:rgba(255,255,255,0.08);\n  --gp-fill:rgba(255,255,255,0.55);\n  --gp-knob:#fff;\n  --gp-knob-border:rgba(255,255,255,0.06);\n  --gp-knob-shadow:0 1px 3px rgba(0,0,0,0.2);\n  --gp-art-shadow:0 4px 12px rgba(0,0,0,0.3);\n  --gp-active:rgba(255,255,255,0.08)\n}\n@keyframes gp-eq{\n  0%,100%{transform:scaleY(0.2)}\n  50%{transform:scaleY(1)}\n}`;\n\nconst P = {\n  glass: \"var(--gp-glass)\",\n  border: \"var(--gp-border)\",\n  shadow: \"var(--gp-shadow)\",\n  dim: \"var(--gp-dim)\",\n  mid: \"var(--gp-mid)\",\n  hi: \"var(--gp-hi)\",\n  track: \"var(--gp-track)\",\n  fill: \"var(--gp-fill)\",\n  knob: \"var(--gp-knob)\",\n  knobBorder: \"var(--gp-knob-border)\",\n  knobShadow: \"var(--gp-knob-shadow)\",\n  artShadow: \"var(--gp-art-shadow)\",\n  active: \"var(--gp-active)\",\n};\n\n/* ── helpers ──────────────────────────────────────────── */\nconst fmt = (s: number) => {\n  const m = Math.floor(s / 60);\n  const sec = Math.floor(s % 60);\n  return `${m}:${sec.toString().padStart(2, \"0\")}`;\n};\n\n/* ═══════════════════════════════════════════════════════════\n   GlassPlayer — iOS 26 liquid-glass Now Playing widget\n   ═══════════════════════════════════════════════════════════ */\ninterface Track {\n  title: string;\n  artist: string;\n  duration: number;\n  art?: string;\n  color?: string;\n}\n\ninterface GlassPlayerProps {\n  tracks: Track[];\n  defaultTrack?: number;\n  sound?: boolean;\n  style?: React.CSSProperties;\n}\n\nfunction GlassPlayer({\n  tracks,\n  defaultTrack = 0,\n  sound = true,\n  style,\n}: GlassPlayerProps) {\n  const [index, setIndex] = React.useState(defaultTrack);\n  const [playing, setPlaying] = React.useState(false);\n  const [progress, setProgress] = React.useState(0);\n  const [volume, setVolume] = React.useState(0.7);\n  const scrubbing = React.useRef(false);\n  const indexRef = React.useRef(index);\n  indexRef.current = index;\n\n  const track = tracks[index] || tracks[0];\n  if (!track) return null;\n\n  /* playback simulation */\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  React.useEffect(() => {\n    if (!playing) return;\n    const id = setInterval(() => {\n      if (scrubbing.current) return;\n      setProgress((p) => {\n        const next = p + 0.25 / track.duration;\n        if (next >= 1) {\n          setIndex((indexRef.current + 1) % tracks.length);\n          return 0;\n        }\n        return next;\n      });\n    }, 250);\n    return () => clearInterval(id);\n  }, [playing, track.duration, tracks.length]);\n\n  const play = () => {\n    setPlaying((p) => !p);\n    if (sound) tick();\n  };\n\n  const prev = () => {\n    if (progress > 0.05) {\n      setProgress(0);\n    } else {\n      setIndex((i) => (i - 1 + tracks.length) % tracks.length);\n      setProgress(0);\n    }\n    if (sound) tick();\n  };\n\n  const next = () => {\n    setIndex((i) => (i + 1) % tracks.length);\n    setProgress(0);\n    if (sound) tick();\n  };\n\n  return (\n    <>\n      <style>{PLAYER_CSS}</style>\n      <motion.div\n        className=\"gp\"\n        initial={{ opacity: 0, y: 8 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.35, ease: [0.25, 0.1, 0.25, 1] }}\n        style={{\n          width: \"100%\",\n          maxWidth: 380,\n          borderRadius: 16,\n          background: P.glass,\n          border: `1px solid ${P.border}`,\n          boxShadow: P.shadow,\n          backdropFilter: \"blur(24px)\",\n          WebkitBackdropFilter: \"blur(24px)\",\n          padding: 16,\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: 16,\n          ...style,\n        }}\n      >\n        {/* ── top: art + info + controls ── */}\n        <div style={{ display: \"flex\", gap: 14, alignItems: \"flex-start\" }}>\n          {/* album art */}\n          <AnimatePresence mode=\"wait\">\n            <motion.div\n              key={index}\n              initial={{ opacity: 0, scale: 0.92 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.92 }}\n              transition={{ duration: 0.2 }}\n              style={{\n                width: 72,\n                height: 72,\n                borderRadius: 12,\n                flexShrink: 0,\n                overflow: \"hidden\",\n                boxShadow: P.artShadow,\n                background: track.art\n                  ? undefined\n                  : `linear-gradient(135deg, ${track.color || \"#667\"} 30%, color-mix(in srgb, ${track.color || \"#667\"} 40%, black) 100%)`,\n              }}\n            >\n              {track.art && (\n                <img\n                  src={track.art}\n                  alt=\"\"\n                  style={{\n                    width: \"100%\",\n                    height: \"100%\",\n                    objectFit: \"cover\",\n                    display: \"block\",\n                  }}\n                />\n              )}\n            </motion.div>\n          </AnimatePresence>\n\n          {/* info + controls */}\n          <div style={{ flex: 1, minWidth: 0, paddingTop: 2 }}>\n            {/* title + eq bars */}\n            <div\n              style={{\n                display: \"flex\",\n                alignItems: \"center\",\n                gap: 8,\n              }}\n            >\n              <div style={{ flex: 1, minWidth: 0 }}>\n                <AnimatePresence mode=\"wait\">\n                  <motion.div\n                    key={`t-${index}`}\n                    initial={{ opacity: 0, y: 4 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    exit={{ opacity: 0, y: -4 }}\n                    transition={{ duration: 0.15 }}\n                    style={{\n                      fontSize: 15,\n                      fontWeight: 600,\n                      color: P.hi,\n                      whiteSpace: \"nowrap\",\n                      overflow: \"hidden\",\n                      textOverflow: \"ellipsis\",\n                      letterSpacing: \"-0.01em\",\n                    }}\n                  >\n                    {track.title}\n                  </motion.div>\n                </AnimatePresence>\n                <AnimatePresence mode=\"wait\">\n                  <motion.div\n                    key={`a-${index}`}\n                    initial={{ opacity: 0, y: 4 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    exit={{ opacity: 0, y: -4 }}\n                    transition={{ duration: 0.15, delay: 0.03 }}\n                    style={{\n                      fontSize: 13,\n                      color: P.dim,\n                      whiteSpace: \"nowrap\",\n                      overflow: \"hidden\",\n                      textOverflow: \"ellipsis\",\n                      marginTop: 2,\n                    }}\n                  >\n                    {track.artist}\n                  </motion.div>\n                </AnimatePresence>\n              </div>\n\n              {/* equalizer bars */}\n              <AnimatePresence>\n                {playing && (\n                  <motion.div\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    exit={{ opacity: 0 }}\n                    style={{\n                      display: \"flex\",\n                      gap: 2,\n                      alignItems: \"flex-end\",\n                      height: 16,\n                      flexShrink: 0,\n                    }}\n                  >\n                    {[0, 0.2, 0.4, 0.15].map((delay, i) => (\n                      <div\n                        key={i}\n                        style={{\n                          width: 2.5,\n                          height: 16,\n                          borderRadius: 1,\n                          background: P.mid,\n                          transformOrigin: \"bottom\",\n                          animation: `gp-eq 0.7s ${delay}s ease-in-out infinite`,\n                        }}\n                      />\n                    ))}\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </div>\n\n            {/* playback controls */}\n            <div\n              style={{\n                display: \"flex\",\n                alignItems: \"center\",\n                gap: 2,\n                marginTop: 10,\n              }}\n            >\n              <CtrlBtn onClick={prev} label=\"Previous\">\n                <svg\n                  width=\"16\"\n                  height=\"16\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"currentColor\"\n                >\n                  <rect x=\"3\" y=\"5\" width=\"2.5\" height=\"14\" rx=\"0.5\" />\n                  <path d=\"M19.5 5.3a1 1 0 0 1 1.5.87v11.66a1 1 0 0 1-1.5.87L8 12.87a1 1 0 0 1 0-1.74L19.5 5.3Z\" />\n                </svg>\n              </CtrlBtn>\n\n              <CtrlBtn onClick={play} label={playing ? \"Pause\" : \"Play\"} size={40}>\n                <AnimatePresence mode=\"wait\" initial={false}>\n                  {playing ? (\n                    <motion.svg\n                      key=\"pause\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"currentColor\"\n                      initial={{ scale: 0.7, opacity: 0 }}\n                      animate={{ scale: 1, opacity: 1 }}\n                      exit={{ scale: 0.7, opacity: 0 }}\n                      transition={{\n                        type: \"spring\",\n                        stiffness: 500,\n                        damping: 30,\n                      }}\n                    >\n                      <rect x=\"5\" y=\"4\" width=\"5\" height=\"16\" rx=\"1\" />\n                      <rect x=\"14\" y=\"4\" width=\"5\" height=\"16\" rx=\"1\" />\n                    </motion.svg>\n                  ) : (\n                    <motion.svg\n                      key=\"play\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"currentColor\"\n                      initial={{ scale: 0.7, opacity: 0 }}\n                      animate={{ scale: 1, opacity: 1 }}\n                      exit={{ scale: 0.7, opacity: 0 }}\n                      transition={{\n                        type: \"spring\",\n                        stiffness: 500,\n                        damping: 30,\n                      }}\n                    >\n                      <path d=\"M6.5 4.27a1 1 0 0 1 1.5-.87l12 6.73a1 1 0 0 1 0 1.74l-12 6.73a1 1 0 0 1-1.5-.87V4.27Z\" />\n                    </motion.svg>\n                  )}\n                </AnimatePresence>\n              </CtrlBtn>\n\n              <CtrlBtn onClick={next} label=\"Next\">\n                <svg\n                  width=\"16\"\n                  height=\"16\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"currentColor\"\n                >\n                  <rect x=\"18.5\" y=\"5\" width=\"2.5\" height=\"14\" rx=\"0.5\" />\n                  <path d=\"M4.5 5.3a1 1 0 0 0-1.5.87v11.66a1 1 0 0 0 1.5.87L16 12.87a1 1 0 0 0 0-1.74L4.5 5.3Z\" />\n                </svg>\n              </CtrlBtn>\n            </div>\n          </div>\n        </div>\n\n        {/* ── progress bar ── */}\n        <div style={{ display: \"flex\", alignItems: \"center\", gap: 10 }}>\n          <span\n            style={{\n              fontSize: 11,\n              color: P.dim,\n              fontVariantNumeric: \"tabular-nums\",\n              minWidth: 32,\n            }}\n          >\n            {fmt(progress * track.duration)}\n          </span>\n          <Scrubber\n            value={progress}\n            onChange={setProgress}\n            onScrubStart={() => {\n              scrubbing.current = true;\n            }}\n            onScrubEnd={() => {\n              scrubbing.current = false;\n            }}\n          />\n          <span\n            style={{\n              fontSize: 11,\n              color: P.dim,\n              fontVariantNumeric: \"tabular-nums\",\n              minWidth: 32,\n              textAlign: \"right\",\n            }}\n          >\n            {fmt(track.duration)}\n          </span>\n        </div>\n\n        {/* ── volume ── */}\n        <div style={{ display: \"flex\", alignItems: \"center\", gap: 8 }}>\n          <div style={{ color: P.dim, flexShrink: 0 }}>\n            <svg\n              width=\"14\"\n              height=\"14\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"1.5\"\n              strokeLinecap=\"round\"\n            >\n              <polygon\n                points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\"\n                fill=\"currentColor\"\n                stroke=\"none\"\n              />\n              {volume > 0 && (\n                <path d=\"M15.54 8.46a5 5 0 0 1 0 7.07\" />\n              )}\n              {volume > 0.5 && (\n                <path d=\"M19.07 4.93a10 10 0 0 1 0 14.14\" />\n              )}\n            </svg>\n          </div>\n          <Scrubber value={volume} onChange={setVolume} thin />\n        </div>\n      </motion.div>\n    </>\n  );\n}\n\n/* ── control button ──────────────────────────────────── */\nfunction CtrlBtn({\n  children,\n  onClick,\n  label,\n  size = 32,\n}: {\n  children: React.ReactNode;\n  onClick: () => void;\n  label: string;\n  size?: number;\n}) {\n  const [h, setH] = React.useState(false);\n\n  return (\n    <motion.button\n      type=\"button\"\n      aria-label={label}\n      onClick={onClick}\n      whileTap={{ scale: 0.9 }}\n      onMouseEnter={() => setH(true)}\n      onMouseLeave={() => setH(false)}\n      style={{\n        width: size,\n        height: size,\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        borderRadius: size / 2,\n        border: \"none\",\n        background: h ? P.active : \"transparent\",\n        color: P.hi,\n        cursor: \"pointer\",\n        padding: 0,\n        transition: \"background 120ms\",\n      }}\n    >\n      {children}\n    </motion.button>\n  );\n}\n\n/* ── scrubber ────────────────────────────────────────── */\nfunction Scrubber({\n  value,\n  onChange,\n  onScrubStart,\n  onScrubEnd,\n  thin,\n}: {\n  value: number;\n  onChange: (v: number) => void;\n  onScrubStart?: () => void;\n  onScrubEnd?: () => void;\n  thin?: boolean;\n}) {\n  const ref = React.useRef<HTMLDivElement>(null);\n  const [dragging, setDragging] = React.useState(false);\n  const [hover, setHover] = React.useState(false);\n\n  const update = (e: React.PointerEvent) => {\n    const rect = ref.current!.getBoundingClientRect();\n    onChange(Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width)));\n  };\n\n  return (\n    <div\n      ref={ref}\n      onMouseEnter={() => setHover(true)}\n      onMouseLeave={() => !dragging && setHover(false)}\n      onPointerDown={(e) => {\n        setDragging(true);\n        onScrubStart?.();\n        e.currentTarget.setPointerCapture(e.pointerId);\n        update(e);\n      }}\n      onPointerMove={(e) => {\n        if (dragging) update(e);\n      }}\n      onPointerUp={() => {\n        setDragging(false);\n        setHover(false);\n        onScrubEnd?.();\n      }}\n      style={{\n        flex: 1,\n        height: 20,\n        display: \"flex\",\n        alignItems: \"center\",\n        cursor: \"pointer\",\n        touchAction: \"none\",\n      }}\n    >\n      <div\n        style={{\n          width: \"100%\",\n          height: thin ? 3 : 4,\n          borderRadius: 2,\n          background: P.track,\n          position: \"relative\",\n          overflow: \"visible\",\n        }}\n      >\n        {/* filled */}\n        <div\n          style={{\n            position: \"absolute\",\n            top: 0,\n            left: 0,\n            height: \"100%\",\n            width: `${value * 100}%`,\n            borderRadius: 2,\n            background: P.fill,\n            transition: dragging ? \"none\" : \"width 200ms linear\",\n          }}\n        />\n        {/* knob */}\n        <motion.div\n          animate={{\n            scale: hover || dragging ? 1 : 0,\n            opacity: hover || dragging ? 1 : 0,\n          }}\n          transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\n          style={{\n            position: \"absolute\",\n            top: \"50%\",\n            left: `${value * 100}%`,\n            width: 12,\n            height: 12,\n            borderRadius: 6,\n            background: P.knob,\n            border: `1px solid ${P.knobBorder}`,\n            boxShadow: P.knobShadow,\n            transform: \"translate(-50%, -50%)\",\n            pointerEvents: \"none\",\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n\n/* ── exports ─────────────────────────────────────────── */\nexport { GlassPlayer };\nexport type { GlassPlayerProps, Track };\n",
      "type": "registry:ui",
      "target": "components/ruixen/glass-player.tsx"
    }
  ]
}
{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "column-collaboration-table",
  "type": "registry:ui",
  "title": "Column Collaboration Table",
  "description": "Glass table with per-column comment threads. Spring-animated popovers, inline comment input, comment count badges. Audio tick on add.",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "registry/ruixenui/column-collaboration-table.tsx",
      "content": "\"use client\";\n\nimport { useState, useRef, useCallback } from \"react\";\nimport { motion, AnimatePresence } from \"motion/react\";\n\n/**\n * Column Collaboration Table — Rauno Freiberg craft.\n *\n * Glass table with per-column comment threads. Click header icon\n * to open spring-animated popover. Add comments inline.\n * Comment count badge. Audio tick on add.\n */\n\n/* ── Audio ── */\n\nlet _a: AudioContext | null = null;\nlet _b: AudioBuffer | null = null;\nfunction getCtx(): AudioContext {\n  if (!_a) _a = new (window.AudioContext || (window as unknown as { webkitAudioContext: typeof AudioContext }).webkitAudioContext)();\n  if (_a.state === \"suspended\") _a.resume();\n  return _a;\n}\nfunction getBuf(ac: AudioContext): AudioBuffer {\n  if (_b && _b.sampleRate === ac.sampleRate) return _b;\n  const len = Math.floor(ac.sampleRate * 0.003);\n  const buf = ac.createBuffer(1, len, ac.sampleRate);\n  const ch = buf.getChannelData(0);\n  for (let i = 0; i < len; i++) ch[i] = (Math.random() * 2 - 1) * (1 - i / len) ** 4;\n  _b = buf; return buf;\n}\nfunction tick(ref: React.MutableRefObject<number>) {\n  const now = performance.now();\n  if (now - ref.current < 25) return;\n  ref.current = now;\n  try { const ac = getCtx(); const s = ac.createBufferSource(); const g = ac.createGain(); s.buffer = getBuf(ac); g.gain.value = 0.06; s.connect(g).connect(ac.destination); s.start(); } catch { /* silent */ }\n}\n\n/* ── Types ── */\n\nexport interface CollabItem {\n  id: string;\n  [key: string]: string;\n}\n\ninterface ColumnCollaborationTableProps {\n  columns?: string[];\n  data?: CollabItem[];\n  sound?: boolean;\n}\n\n/* ── Defaults ── */\n\nconst DEFAULT_COLS = [\"Name\", \"Email\", \"Location\", \"Status\", \"Balance\"];\n\nconst DEFAULT_DATA: CollabItem[] = [\n  { id: \"1\", Name: \"Arjun Mehta\", Email: \"arjun.mehta@company.com\", Location: \"Bangalore, IN\", Status: \"Active\", Balance: \"$1,250.00\" },\n  { id: \"2\", Name: \"Hannah Park\", Email: \"hannah.park@company.com\", Location: \"Seoul, KR\", Status: \"Active\", Balance: \"$600.00\" },\n  { id: \"3\", Name: \"Oliver Scott\", Email: \"oliver.scott@company.com\", Location: \"Manchester, UK\", Status: \"Inactive\", Balance: \"$650.00\" },\n  { id: \"4\", Name: \"Camila Torres\", Email: \"camila.torres@company.com\", Location: \"Bogotá, CO\", Status: \"Active\", Balance: \"$0.00\" },\n  { id: \"5\", Name: \"Kenji Tanaka\", Email: \"kenji.tanaka@company.com\", Location: \"Osaka, JP\", Status: \"Active\", Balance: \"-$1,000.00\" },\n];\n\n/* ── CSS ── */\n\nconst CSS = `.cct{--t-bg:rgba(255,255,255,.72);--t-border:rgba(0,0,0,.06);--t-shadow:0 0 0 .5px rgba(0,0,0,.04),0 2px 4px rgba(0,0,0,.04),0 8px 24px rgba(0,0,0,.06);--t-ink:0,0,0}.dark .cct,[data-theme=\"dark\"] .cct{--t-bg:rgba(30,30,32,.82);--t-border:rgba(255,255,255,.06);--t-shadow:0 0 0 .5px rgba(255,255,255,.04),0 2px 4px rgba(0,0,0,.2),0 8px 24px rgba(0,0,0,.3);--t-ink:255,255,255}.cct-row{transition:background .1s}.cct-row:hover{background:rgba(var(--t-ink),.03)}.cct-inp{background:rgba(var(--t-ink),.03);border:1px solid rgba(var(--t-ink),.08);border-radius:6px;padding:6px 10px;font-size:12px;font-weight:420;color:rgba(var(--t-ink),.8);outline:none;width:100%;transition:border-color .15s}.cct-inp:focus{border-color:rgba(var(--t-ink),.2)}`;\n\nconst TH: React.CSSProperties = {\n  padding: \"10px 16px\", fontSize: 11, fontWeight: 520,\n  color: \"rgba(var(--t-ink),.4)\", letterSpacing: \"0.04em\",\n  textTransform: \"uppercase\", textAlign: \"left\", whiteSpace: \"nowrap\",\n  borderBottom: \"1px solid var(--t-border)\", position: \"relative\",\n};\n\nconst TD: React.CSSProperties = {\n  padding: \"10px 16px\", fontSize: 13, fontWeight: 420,\n  color: \"rgba(var(--t-ink),.7)\",\n  borderBottom: \"1px solid rgba(var(--t-ink),.03)\", whiteSpace: \"nowrap\",\n};\n\n/* ── Component ── */\n\nexport function ColumnCollaborationTable({\n  columns = DEFAULT_COLS,\n  data = DEFAULT_DATA,\n  sound = true,\n}: ColumnCollaborationTableProps) {\n  const [comments, setComments] = useState<Record<string, string[]>>({});\n  const [newComment, setNewComment] = useState<Record<string, string>>({});\n  const [openCol, setOpenCol] = useState<string | null>(null);\n  const lastSound = useRef(0);\n\n  const addComment = useCallback((col: string) => {\n    const text = newComment[col]?.trim();\n    if (!text) return;\n    setComments((prev) => ({ ...prev, [col]: [...(prev[col] || []), text] }));\n    setNewComment((prev) => ({ ...prev, [col]: \"\" }));\n    if (sound) tick(lastSound);\n  }, [newComment, sound]);\n\n  return (\n    <div className=\"cct\" style={{\n      width: \"100%\", maxWidth: 760,\n      background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n      boxShadow: \"var(--t-shadow)\", borderRadius: 14,\n      backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n      overflow: \"hidden\",\n    }}>\n      <style dangerouslySetInnerHTML={{ __html: CSS }} />\n\n      <div style={{ padding: \"12px 16px 8px\", fontSize: 13, fontWeight: 560, color: \"rgba(var(--t-ink),.85)\", letterSpacing: \"-0.01em\" }}>\n        Team Directory\n      </div>\n\n      <table style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\n        <thead>\n          <tr>\n            {columns.map((col) => {\n              const count = (comments[col] || []).length;\n              return (\n                <th key={col} style={TH}>\n                  <div style={{ display: \"flex\", alignItems: \"center\", gap: 6 }}>\n                    <span>{col}</span>\n                    <button\n                      onClick={() => setOpenCol(openCol === col ? null : col)}\n                      style={{\n                        border: \"none\", background: count > 0 ? \"rgba(var(--t-ink),.06)\" : \"none\",\n                        borderRadius: 4, padding: \"2px 4px\", cursor: \"pointer\",\n                        display: \"flex\", alignItems: \"center\", gap: 3,\n                      }}\n                    >\n                      <svg width=\"12\" height=\"12\" viewBox=\"0 0 16 16\" fill=\"none\">\n                        <path d=\"M2 3h12v8a1 1 0 01-1 1H7l-3 2v-2H3a1 1 0 01-1-1V3z\" stroke=\"rgba(var(--t-ink),.3)\" strokeWidth=\"1.2\" fill=\"none\" strokeLinecap=\"round\" />\n                      </svg>\n                      {count > 0 && (\n                        <span style={{ fontSize: 9, fontWeight: 600, color: \"rgba(var(--t-ink),.5)\" }}>{count}</span>\n                      )}\n                    </button>\n\n                    {/* Popover */}\n                    <AnimatePresence>\n                      {openCol === col && (\n                        <motion.div\n                          initial={{ opacity: 0, scale: 0.95, y: -4 }}\n                          animate={{ opacity: 1, scale: 1, y: 0 }}\n                          exit={{ opacity: 0, scale: 0.95, y: -4 }}\n                          transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\n                          style={{\n                            position: \"absolute\", left: 8, top: \"calc(100% + 4px)\", zIndex: 20,\n                            background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n                            boxShadow: \"var(--t-shadow)\", borderRadius: 10, padding: 12,\n                            width: 240, backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n                          }}\n                          onClick={(e) => e.stopPropagation()}\n                        >\n                          <div style={{ fontSize: 11, fontWeight: 520, color: \"rgba(var(--t-ink),.5)\", marginBottom: 8, textTransform: \"uppercase\", letterSpacing: \"0.04em\" }}>\n                            Comments — {col}\n                          </div>\n                          <div style={{ maxHeight: 120, overflowY: \"auto\", marginBottom: 8 }}>\n                            {(comments[col] || []).length === 0 ? (\n                              <div style={{ fontSize: 12, color: \"rgba(var(--t-ink),.3)\", padding: \"4px 0\" }}>No comments yet</div>\n                            ) : (\n                              (comments[col] || []).map((cmt, i) => (\n                                <motion.div\n                                  key={i}\n                                  initial={{ opacity: 0, y: -4 }}\n                                  animate={{ opacity: 1, y: 0 }}\n                                  transition={{ type: \"spring\", stiffness: 400, damping: 28 }}\n                                  style={{\n                                    fontSize: 12, color: \"rgba(var(--t-ink),.65)\", padding: \"5px 0\",\n                                    borderBottom: i < (comments[col] || []).length - 1 ? \"1px solid rgba(var(--t-ink),.04)\" : \"none\",\n                                  }}\n                                >\n                                  {cmt}\n                                </motion.div>\n                              ))\n                            )}\n                          </div>\n                          <div style={{ display: \"flex\", gap: 6 }}>\n                            <input\n                              className=\"cct-inp\"\n                              value={newComment[col] || \"\"}\n                              onChange={(e) => setNewComment((prev) => ({ ...prev, [col]: e.target.value }))}\n                              placeholder=\"Add comment...\"\n                              onKeyDown={(e) => e.key === \"Enter\" && addComment(col)}\n                            />\n                            <button\n                              onClick={() => addComment(col)}\n                              style={{\n                                border: \"none\", background: \"rgba(var(--t-ink),.08)\", borderRadius: 6,\n                                padding: \"0 10px\", fontSize: 11, fontWeight: 520,\n                                color: \"rgba(var(--t-ink),.6)\", cursor: \"pointer\",\n                                whiteSpace: \"nowrap\",\n                              }}\n                            >\n                              Add\n                            </button>\n                          </div>\n                        </motion.div>\n                      )}\n                    </AnimatePresence>\n                  </div>\n                </th>\n              );\n            })}\n          </tr>\n        </thead>\n        <tbody>\n          {data.map((item) => (\n            <tr key={item.id} className=\"cct-row\">\n              {columns.map((col, ci) => (\n                <td key={col} style={{\n                  ...TD,\n                  fontWeight: ci === 0 ? 500 : TD.fontWeight,\n                  color: ci === 0 ? \"rgba(var(--t-ink),.85)\" : TD.color,\n                }}>\n                  {item[col] || \"—\"}\n                </td>\n              ))}\n            </tr>\n          ))}\n        </tbody>\n      </table>\n\n      {/* Click-away */}\n      {openCol && <div onClick={() => setOpenCol(null)} style={{ position: \"fixed\", inset: 0, zIndex: 15 }} />}\n\n      <div style={{\n        display: \"flex\", justifyContent: \"space-between\", padding: \"10px 16px\",\n        borderTop: \"1px solid var(--t-border)\",\n      }}>\n        <span style={{ fontSize: 11, fontWeight: 450, color: \"rgba(var(--t-ink),.35)\" }}>\n          {data.length} rows\n        </span>\n        <span style={{ fontSize: 11, fontWeight: 450, color: \"rgba(var(--t-ink),.35)\" }}>\n          {Object.values(comments).reduce((s, c) => s + c.length, 0)} comments\n        </span>\n      </div>\n    </div>\n  );\n}\n\nexport default ColumnCollaborationTable;\n",
      "type": "registry:ui",
      "target": "components/ruixen/column-collaboration-table.tsx"
    }
  ]
}
{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "table-dialog",
  "type": "registry:ui",
  "title": "Table Dialog",
  "description": "Glass table with row selection, status dots, three-dot action menu, and spring-animated edit dialog overlay. Inline form fields.",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "registry/ruixenui/table-dialog.tsx",
      "content": "\"use client\";\n\nimport { useState, useRef, useCallback } from \"react\";\nimport { motion, AnimatePresence } from \"motion/react\";\n\n/**\n * Table Dialog — Rauno Freiberg craft.\n *\n * Glass table with row selection, status dots, and a spring-animated\n * edit dialog overlay. Three-dot menu per row. Inline form fields.\n * Audio tick on save/open.\n */\n\n/* ── Audio ── */\n\nlet _a: AudioContext | null = null;\nlet _b: AudioBuffer | null = null;\nfunction getCtx(): AudioContext {\n  if (!_a) _a = new (window.AudioContext || (window as unknown as { webkitAudioContext: typeof AudioContext }).webkitAudioContext)();\n  if (_a.state === \"suspended\") _a.resume();\n  return _a;\n}\nfunction getBuf(ac: AudioContext): AudioBuffer {\n  if (_b && _b.sampleRate === ac.sampleRate) return _b;\n  const len = Math.floor(ac.sampleRate * 0.003);\n  const buf = ac.createBuffer(1, len, ac.sampleRate);\n  const ch = buf.getChannelData(0);\n  for (let i = 0; i < len; i++) ch[i] = (Math.random() * 2 - 1) * (1 - i / len) ** 4;\n  _b = buf; return buf;\n}\nfunction tick(ref: React.MutableRefObject<number>) {\n  const now = performance.now();\n  if (now - ref.current < 25) return;\n  ref.current = now;\n  try { const ac = getCtx(); const s = ac.createBufferSource(); const g = ac.createGain(); s.buffer = getBuf(ac); g.gain.value = 0.06; s.connect(g).connect(ac.destination); s.start(); } catch { /* silent */ }\n}\n\n/* ── Types ── */\n\nexport interface UserRow {\n  id: string;\n  name: string;\n  email: string;\n  role: string;\n  status: \"Active\" | \"Inactive\";\n  balance: string;\n}\n\ninterface TableDialogProps {\n  data?: UserRow[];\n  sound?: boolean;\n}\n\n/* ── Defaults ── */\n\nconst DEFAULTS: UserRow[] = [\n  { id: \"1\", name: \"Arjun Mehta\", email: \"arjun.mehta@company.com\", role: \"Manager\", status: \"Active\", balance: \"$1,250.00\" },\n  { id: \"2\", name: \"Hannah Park\", email: \"hannah.park@company.com\", role: \"Designer\", status: \"Active\", balance: \"$600.00\" },\n  { id: \"3\", name: \"Oliver Scott\", email: \"oliver.scott@company.com\", role: \"Engineer\", status: \"Inactive\", balance: \"$650.00\" },\n  { id: \"4\", name: \"Camila Torres\", email: \"camila.torres@company.com\", role: \"Engineer\", status: \"Active\", balance: \"$900.00\" },\n];\n\n/* ── CSS ── */\n\nconst CSS = `.tbd{--t-bg:rgba(255,255,255,.72);--t-border:rgba(0,0,0,.06);--t-shadow:0 0 0 .5px rgba(0,0,0,.04),0 2px 4px rgba(0,0,0,.04),0 8px 24px rgba(0,0,0,.06);--t-ink:0,0,0;--t-ok:#34C759;--t-dim:#FF3B30}.dark .tbd,[data-theme=\"dark\"] .tbd{--t-bg:rgba(30,30,32,.82);--t-border:rgba(255,255,255,.06);--t-shadow:0 0 0 .5px rgba(255,255,255,.04),0 2px 4px rgba(0,0,0,.2),0 8px 24px rgba(0,0,0,.3);--t-ink:255,255,255;--t-ok:#30D158;--t-dim:#FF453A}.tbd-row{transition:background .1s}.tbd-row:hover{background:rgba(var(--t-ink),.03)}.tbd-input{background:rgba(var(--t-ink),.03);border:1px solid rgba(var(--t-ink),.08);border-radius:8px;padding:8px 12px;font-size:13px;font-weight:420;color:rgba(var(--t-ink),.8);outline:none;width:100%;transition:border-color .15s}.tbd-input:focus{border-color:rgba(var(--t-ink),.2)}`;\n\nconst TH: React.CSSProperties = {\n  padding: \"10px 16px\", fontSize: 11, fontWeight: 520,\n  color: \"rgba(var(--t-ink),.4)\", letterSpacing: \"0.04em\",\n  textTransform: \"uppercase\", textAlign: \"left\", whiteSpace: \"nowrap\",\n  borderBottom: \"1px solid var(--t-border)\",\n};\n\nconst TD: React.CSSProperties = {\n  padding: \"10px 16px\", fontSize: 13, fontWeight: 420,\n  color: \"rgba(var(--t-ink),.7)\",\n  borderBottom: \"1px solid rgba(var(--t-ink),.03)\", whiteSpace: \"nowrap\",\n};\n\n/* ── Component ── */\n\nexport function TableDialog({\n  data = DEFAULTS,\n  sound = true,\n}: TableDialogProps) {\n  const [users, setUsers] = useState<UserRow[]>(data);\n  const [selected, setSelected] = useState<Set<string>>(new Set());\n  const [editing, setEditing] = useState<UserRow | null>(null);\n  const [editData, setEditData] = useState<Partial<UserRow>>({});\n  const [menuOpen, setMenuOpen] = useState<string | null>(null);\n  const lastSound = useRef(0);\n\n  const toggleSelect = useCallback((id: string) => {\n    setSelected((prev) => {\n      const next = new Set(prev);\n      if (next.has(id)) next.delete(id); else next.add(id);\n      return next;\n    });\n  }, []);\n\n  const toggleAll = useCallback(() => {\n    setSelected((prev) => prev.size === users.length ? new Set() : new Set(users.map((u) => u.id)));\n  }, [users]);\n\n  const openEdit = useCallback((user: UserRow) => {\n    setEditing(user);\n    setEditData({ ...user });\n    setMenuOpen(null);\n    if (sound) tick(lastSound);\n  }, [sound]);\n\n  const saveEdit = useCallback(() => {\n    if (!editing) return;\n    setUsers((prev) => prev.map((u) => u.id === editing.id ? { ...u, ...editData } as UserRow : u));\n    setEditing(null);\n    if (sound) tick(lastSound);\n  }, [editing, editData, sound]);\n\n  const deleteUser = useCallback((id: string) => {\n    setUsers((prev) => prev.filter((u) => u.id !== id));\n    setMenuOpen(null);\n    if (sound) tick(lastSound);\n  }, [sound]);\n\n  const total = users.reduce((s, u) => {\n    const n = parseFloat(u.balance.replace(/[^0-9.-]/g, \"\"));\n    return s + (isNaN(n) ? 0 : n);\n  }, 0);\n\n  return (\n    <div className=\"tbd\" style={{\n      width: \"100%\", maxWidth: 720, position: \"relative\",\n      background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n      boxShadow: \"var(--t-shadow)\", borderRadius: 14,\n      backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n      overflow: \"hidden\",\n    }}>\n      <style dangerouslySetInnerHTML={{ __html: CSS }} />\n\n      <table style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\n        <thead>\n          <tr>\n            <th style={{ ...TH, width: 40, textAlign: \"center\", cursor: \"pointer\" }} onClick={toggleAll}>\n              <span style={{\n                display: \"inline-flex\", width: 16, height: 16, borderRadius: 4,\n                border: `1.5px solid rgba(var(--t-ink),${selected.size === users.length ? \".5\" : \".15\"})`,\n                background: selected.size === users.length ? \"rgba(var(--t-ink),.08)\" : \"none\",\n                alignItems: \"center\", justifyContent: \"center\",\n              }}>\n                {selected.size === users.length && (\n                  <svg width=\"8\" height=\"8\" viewBox=\"0 0 8 8\"><path d=\"M1.5 4L3 5.5L6.5 2\" stroke=\"rgba(var(--t-ink),.6)\" strokeWidth=\"1.2\" fill=\"none\" strokeLinecap=\"round\" /></svg>\n                )}\n              </span>\n            </th>\n            <th style={TH}>Name</th>\n            <th style={TH}>Email</th>\n            <th style={TH}>Role</th>\n            <th style={TH}>Status</th>\n            <th style={{ ...TH, textAlign: \"right\" }}>Balance</th>\n            <th style={{ ...TH, width: 44 }} />\n          </tr>\n        </thead>\n        <tbody>\n          <AnimatePresence mode=\"popLayout\">\n            {users.map((user) => {\n              const isSel = selected.has(user.id);\n              return (\n                <motion.tr\n                  key={user.id}\n                  layout\n                  exit={{ opacity: 0, height: 0 }}\n                  transition={{ type: \"spring\", stiffness: 400, damping: 30 }}\n                  className=\"tbd-row\"\n                  style={{ background: isSel ? \"rgba(var(--t-ink),.03)\" : undefined }}\n                >\n                  <td style={{ ...TD, textAlign: \"center\", cursor: \"pointer\" }} onClick={() => toggleSelect(user.id)}>\n                    <span style={{\n                      display: \"inline-flex\", width: 16, height: 16, borderRadius: 4,\n                      border: `1.5px solid rgba(var(--t-ink),${isSel ? \".5\" : \".15\"})`,\n                      background: isSel ? \"rgba(var(--t-ink),.08)\" : \"none\",\n                      alignItems: \"center\", justifyContent: \"center\",\n                    }}>\n                      {isSel && (\n                        <svg width=\"8\" height=\"8\" viewBox=\"0 0 8 8\"><path d=\"M1.5 4L3 5.5L6.5 2\" stroke=\"rgba(var(--t-ink),.6)\" strokeWidth=\"1.2\" fill=\"none\" strokeLinecap=\"round\" /></svg>\n                      )}\n                    </span>\n                  </td>\n                  <td style={{ ...TD, fontWeight: 500, color: \"rgba(var(--t-ink),.85)\" }}>{user.name}</td>\n                  <td style={TD}>{user.email}</td>\n                  <td style={TD}>{user.role}</td>\n                  <td style={TD}>\n                    <span style={{ display: \"inline-flex\", alignItems: \"center\", gap: 6 }}>\n                      <span style={{ width: 6, height: 6, borderRadius: \"50%\", background: user.status === \"Active\" ? \"var(--t-ok)\" : \"var(--t-dim)\" }} />\n                      <span style={{ fontSize: 12, color: \"rgba(var(--t-ink),.5)\" }}>{user.status}</span>\n                    </span>\n                  </td>\n                  <td style={{ ...TD, textAlign: \"right\", fontVariantNumeric: \"tabular-nums\" }}>{user.balance}</td>\n                  <td style={{ ...TD, position: \"relative\" }}>\n                    <button\n                      onClick={() => setMenuOpen(menuOpen === user.id ? null : user.id)}\n                      style={{\n                        border: \"none\", background: \"none\", cursor: \"pointer\",\n                        padding: 4, borderRadius: 4, display: \"flex\", alignItems: \"center\",\n                      }}\n                    >\n                      <svg width=\"14\" height=\"14\" viewBox=\"0 0 14 14\" fill=\"none\">\n                        <circle cx=\"3\" cy=\"7\" r=\"1.2\" fill=\"rgba(var(--t-ink),.35)\" />\n                        <circle cx=\"7\" cy=\"7\" r=\"1.2\" fill=\"rgba(var(--t-ink),.35)\" />\n                        <circle cx=\"11\" cy=\"7\" r=\"1.2\" fill=\"rgba(var(--t-ink),.35)\" />\n                      </svg>\n                    </button>\n                    <AnimatePresence>\n                      {menuOpen === user.id && (\n                        <motion.div\n                          initial={{ opacity: 0, scale: 0.95, y: -4 }}\n                          animate={{ opacity: 1, scale: 1, y: 0 }}\n                          exit={{ opacity: 0, scale: 0.95, y: -4 }}\n                          transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\n                          style={{\n                            position: \"absolute\", right: 16, top: \"100%\", zIndex: 20,\n                            background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n                            boxShadow: \"var(--t-shadow)\", borderRadius: 8, padding: \"4px 0\",\n                            minWidth: 100, backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n                          }}\n                        >\n                          <button\n                            onClick={() => openEdit(user)}\n                            style={{\n                              display: \"block\", width: \"100%\", padding: \"6px 12px\",\n                              border: \"none\", background: \"none\", cursor: \"pointer\",\n                              fontSize: 12, fontWeight: 450, color: \"rgba(var(--t-ink),.7)\",\n                              textAlign: \"left\",\n                            }}\n                          >\n                            Edit\n                          </button>\n                          <button\n                            onClick={() => deleteUser(user.id)}\n                            style={{\n                              display: \"block\", width: \"100%\", padding: \"6px 12px\",\n                              border: \"none\", background: \"none\", cursor: \"pointer\",\n                              fontSize: 12, fontWeight: 450, color: \"var(--t-dim)\",\n                              textAlign: \"left\",\n                            }}\n                          >\n                            Delete\n                          </button>\n                        </motion.div>\n                      )}\n                    </AnimatePresence>\n                  </td>\n                </motion.tr>\n              );\n            })}\n          </AnimatePresence>\n        </tbody>\n      </table>\n\n      {/* Click-away for menu */}\n      {menuOpen && <div onClick={() => setMenuOpen(null)} style={{ position: \"fixed\", inset: 0, zIndex: 15 }} />}\n\n      {/* Footer */}\n      <div style={{\n        display: \"flex\", justifyContent: \"space-between\", padding: \"10px 16px\",\n        borderTop: \"1px solid var(--t-border)\",\n      }}>\n        <span style={{ fontSize: 11, fontWeight: 450, color: \"rgba(var(--t-ink),.35)\" }}>\n          {selected.size > 0 ? `${selected.size} selected` : `${users.length} members`}\n        </span>\n        <span style={{ fontSize: 12, fontWeight: 520, color: \"rgba(var(--t-ink),.65)\", fontVariantNumeric: \"tabular-nums\" }}>\n          Total: ${total.toLocaleString(undefined, { minimumFractionDigits: 2 })}\n        </span>\n      </div>\n\n      {/* Edit Dialog Overlay */}\n      <AnimatePresence>\n        {editing && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            style={{\n              position: \"fixed\", inset: 0, zIndex: 50,\n              background: \"rgba(0,0,0,.3)\", backdropFilter: \"blur(4px)\",\n              display: \"flex\", alignItems: \"center\", justifyContent: \"center\",\n            }}\n            onClick={() => setEditing(null)}\n          >\n            <motion.div\n              initial={{ scale: 0.92, opacity: 0, y: 16 }}\n              animate={{ scale: 1, opacity: 1, y: 0 }}\n              exit={{ scale: 0.92, opacity: 0, y: 16 }}\n              transition={{ type: \"spring\", stiffness: 400, damping: 28 }}\n              onClick={(e) => e.stopPropagation()}\n              style={{\n                width: 360, padding: 20, borderRadius: 14,\n                background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n                boxShadow: \"0 24px 64px rgba(0,0,0,.2)\",\n                backdropFilter: \"blur(24px)\", WebkitBackdropFilter: \"blur(24px)\",\n              }}\n            >\n              <div style={{ fontSize: 15, fontWeight: 560, color: \"rgba(var(--t-ink),.85)\", marginBottom: 16 }}>\n                Edit User\n              </div>\n              <div style={{ display: \"flex\", flexDirection: \"column\", gap: 10 }}>\n                {([\"name\", \"email\", \"role\", \"balance\"] as const).map((field) => (\n                  <input\n                    key={field}\n                    className=\"tbd-input\"\n                    placeholder={field.charAt(0).toUpperCase() + field.slice(1)}\n                    value={editData[field] || \"\"}\n                    onChange={(e) => setEditData((prev) => ({ ...prev, [field]: e.target.value }))}\n                  />\n                ))}\n                <div style={{ display: \"flex\", gap: 6, marginTop: 4 }}>\n                  {([\"Active\", \"Inactive\"] as const).map((s) => (\n                    <button\n                      key={s}\n                      onClick={() => setEditData((prev) => ({ ...prev, status: s }))}\n                      style={{\n                        flex: 1, padding: \"7px 0\", borderRadius: 8, fontSize: 12, fontWeight: 500,\n                        border: `1.5px solid rgba(var(--t-ink),${editData.status === s ? \".2\" : \".06\"})`,\n                        background: editData.status === s ? \"rgba(var(--t-ink),.05)\" : \"none\",\n                        color: editData.status === s ? \"rgba(var(--t-ink),.8)\" : \"rgba(var(--t-ink),.35)\",\n                        cursor: \"pointer\", transition: \"all .15s\",\n                      }}\n                    >\n                      {s}\n                    </button>\n                  ))}\n                </div>\n              </div>\n              <div style={{ display: \"flex\", justifyContent: \"flex-end\", gap: 8, marginTop: 16 }}>\n                <button\n                  onClick={() => setEditing(null)}\n                  style={{\n                    padding: \"7px 16px\", borderRadius: 8, border: \"1px solid var(--t-border)\",\n                    background: \"none\", fontSize: 12, fontWeight: 500,\n                    color: \"rgba(var(--t-ink),.5)\", cursor: \"pointer\",\n                  }}\n                >\n                  Cancel\n                </button>\n                <button\n                  onClick={saveEdit}\n                  style={{\n                    padding: \"7px 16px\", borderRadius: 8, border: \"none\",\n                    background: \"rgba(var(--t-ink),.85)\", fontSize: 12, fontWeight: 520,\n                    color: \"rgba(var(--t-ink),.05) !important\", cursor: \"pointer\",\n                  }}\n                >\n                  <span style={{ color: \"rgba(calc(255 - var(--t-ink)),calc(255 - var(--t-ink)),calc(255 - var(--t-ink)),.9)\" }}>Save</span>\n                </button>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n\nexport default TableDialog;\n",
      "type": "registry:ui",
      "target": "components/ruixen/table-dialog.tsx"
    }
  ]
}
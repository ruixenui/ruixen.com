{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "funnel-chart",
  "type": "registry:ui",
  "title": "Funnel Chart",
  "description": "A versatile funnel chart component for visualizing conversion flows, sales pipelines, and sequential data with multiple variants and tooltip styles.",
  "dependencies": [
    "recharts"
  ],
  "files": [
    {
      "path": "registry/ruixenui/funnel-chart.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport {\n  FunnelChart as RechartsFunnelChart,\n  Funnel,\n  Cell,\n  Tooltip,\n  LabelList,\n  ResponsiveContainer,\n  Trapezoid,\n} from \"recharts\";\n\nimport { cn } from \"@/lib/utils\";\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface FunnelDataItem {\n  name: string;\n  value: number;\n  fill?: string;\n}\n\nexport type TooltipIndicator = \"dot\" | \"line\" | \"dashed\";\n\nexport interface FunnelChartBaseProps {\n  data: FunnelDataItem[];\n  className?: string;\n  showTooltip?: boolean;\n  tooltipIndicator?: TooltipIndicator;\n  valueFormatter?: (value: number) => string;\n}\n\n// ============================================================================\n// Neutral Color Palette (shadcn style)\n// ============================================================================\n\nconst NEUTRAL_COLORS = [\n  \"hsl(220 9% 20%)\",\n  \"hsl(220 9% 32%)\",\n  \"hsl(220 9% 44%)\",\n  \"hsl(220 9% 56%)\",\n  \"hsl(220 9% 68%)\",\n  \"hsl(220 9% 78%)\",\n];\n\n// ============================================================================\n// Utility Functions\n// ============================================================================\n\nfunction defaultValueFormatter(value: number): string {\n  if (value >= 1000000) {\n    return `${(value / 1000000).toFixed(1)}M`;\n  }\n  if (value >= 1000) {\n    return `${(value / 1000).toFixed(1)}K`;\n  }\n  return value.toLocaleString();\n}\n\nfunction getColor(index: number): string {\n  return NEUTRAL_COLORS[index % NEUTRAL_COLORS.length];\n}\n\n// ============================================================================\n// Custom Tooltip Component (shadcn style with indicator variants)\n// ============================================================================\n\ninterface ChartTooltipProps {\n  active?: boolean;\n  payload?: Array<{\n    name: string;\n    value: number;\n    payload: FunnelDataItem & { fill?: string };\n  }>;\n  indicator?: TooltipIndicator;\n  valueFormatter: (value: number) => string;\n  hideLabel?: boolean;\n  label?: string;\n}\n\nfunction ChartTooltip({\n  active,\n  payload,\n  indicator = \"dot\",\n  valueFormatter,\n  hideLabel = false,\n  label,\n}: ChartTooltipProps) {\n  if (!active || !payload?.length) return null;\n\n  const data = payload[0];\n  const indicatorColor = data.payload.fill;\n\n  return (\n    <div className=\"rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\">\n      {!hideLabel && label && (\n        <div className=\"mb-1.5 font-medium text-foreground\">{label}</div>\n      )}\n      <div className=\"grid gap-1.5\">\n        <div\n          className={cn(\n            \"flex w-full items-stretch gap-2\",\n            indicator === \"dot\" && \"items-center\",\n          )}\n        >\n          {/* Indicator */}\n          <div\n            className={cn(\"shrink-0 rounded-[2px]\", {\n              \"h-2.5 w-2.5\": indicator === \"dot\",\n              \"w-1 self-stretch\": indicator === \"line\",\n              \"w-0 border-[1.5px] border-dashed bg-transparent self-stretch\":\n                indicator === \"dashed\",\n            })}\n            style={{\n              backgroundColor:\n                indicator !== \"dashed\" ? indicatorColor : undefined,\n              borderColor: indicator === \"dashed\" ? indicatorColor : undefined,\n            }}\n          />\n          {/* Content */}\n          <div className=\"flex flex-1 justify-between items-center gap-4\">\n            <span className=\"text-muted-foreground\">{data.name}</span>\n            <span className=\"font-mono font-medium tabular-nums text-foreground\">\n              {valueFormatter(data.value)}\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// ============================================================================\n// Legend Component\n// ============================================================================\n\ninterface ChartLegendProps {\n  data: Array<{ name: string; fill: string }>;\n  className?: string;\n}\n\nfunction ChartLegend({ data, className }: ChartLegendProps) {\n  return (\n    <div className={cn(\"flex items-center justify-center gap-4\", className)}>\n      {data.map((item, index) => (\n        <div key={index} className=\"flex items-center gap-1.5\">\n          <div\n            className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n            style={{ backgroundColor: item.fill }}\n          />\n          <span className=\"text-sm text-muted-foreground\">{item.name}</span>\n        </div>\n      ))}\n    </div>\n  );\n}\n\n// ============================================================================\n// 1. Funnel Chart - Default\n// ============================================================================\n\ninterface FunnelChartProps extends FunnelChartBaseProps {\n  labelPosition?: \"left\" | \"right\";\n  labelOffset?: number;\n}\n\nfunction FunnelChart({\n  data,\n  className,\n  showTooltip = true,\n  tooltipIndicator = \"dot\",\n  valueFormatter = defaultValueFormatter,\n  labelPosition = \"right\",\n  labelOffset = 12,\n}: FunnelChartProps) {\n  const chartData = data.map((item, index) => ({\n    ...item,\n    fill: item.fill || getColor(index),\n  }));\n\n  return (\n    <div className={cn(\"w-full\", className)}>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <RechartsFunnelChart>\n          {showTooltip && (\n            <Tooltip\n              content={\n                <ChartTooltip\n                  indicator={tooltipIndicator}\n                  valueFormatter={valueFormatter}\n                />\n              }\n              cursor={false}\n            />\n          )}\n          <Funnel\n            data={chartData}\n            dataKey=\"value\"\n            nameKey=\"name\"\n            isAnimationActive={true}\n            animationDuration={800}\n            animationEasing=\"ease-out\"\n          >\n            {chartData.map((entry, index) => (\n              <Cell key={`cell-${index}`} fill={entry.fill} stroke=\"none\" />\n            ))}\n            <LabelList\n              dataKey=\"value\"\n              position={labelPosition}\n              fill=\"hsl(var(--foreground))\"\n              fontSize={12}\n              content={(props: any) => {\n                const { x, y, width, height, value } = props;\n                const xPos =\n                  labelPosition === \"right\"\n                    ? x + width + labelOffset\n                    : x - labelOffset;\n                const textAnchor = labelPosition === \"right\" ? \"start\" : \"end\";\n\n                return (\n                  <text\n                    x={xPos}\n                    y={y + height / 2}\n                    fill=\"hsl(var(--foreground))\"\n                    fontSize={12}\n                    dominantBaseline=\"middle\"\n                    textAnchor={textAnchor}\n                  >\n                    {valueFormatter(value)}\n                  </text>\n                );\n              }}\n            />\n          </Funnel>\n        </RechartsFunnelChart>\n      </ResponsiveContainer>\n    </div>\n  );\n}\n\n// ============================================================================\n// 2. Funnel Chart - Label\n// ============================================================================\n\ninterface FunnelLabelChartProps extends FunnelChartBaseProps {\n  labelPosition?: \"left\" | \"right\";\n  labelOffset?: number;\n}\n\nfunction FunnelLabelChart({\n  data,\n  className,\n  showTooltip = true,\n  tooltipIndicator = \"dot\",\n  valueFormatter = defaultValueFormatter,\n  labelPosition = \"right\",\n  labelOffset = 12,\n}: FunnelLabelChartProps) {\n  const chartData = data.map((item, index) => ({\n    ...item,\n    fill: item.fill || getColor(index),\n  }));\n\n  return (\n    <div className={cn(\"w-full\", className)}>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <RechartsFunnelChart>\n          {showTooltip && (\n            <Tooltip\n              content={\n                <ChartTooltip\n                  indicator={tooltipIndicator}\n                  valueFormatter={valueFormatter}\n                />\n              }\n              cursor={false}\n            />\n          )}\n          <Funnel\n            data={chartData}\n            dataKey=\"value\"\n            nameKey=\"name\"\n            isAnimationActive={true}\n            animationDuration={800}\n          >\n            {chartData.map((entry, index) => (\n              <Cell key={`cell-${index}`} fill={entry.fill} stroke=\"none\" />\n            ))}\n            <LabelList\n              dataKey=\"name\"\n              position={labelPosition}\n              fill=\"hsl(var(--foreground))\"\n              fontSize={13}\n              fontWeight={500}\n              content={(props: any) => {\n                const { x, y, width, height, value } = props;\n                const xPos =\n                  labelPosition === \"right\"\n                    ? x + width + labelOffset\n                    : x - labelOffset;\n                const textAnchor = labelPosition === \"right\" ? \"start\" : \"end\";\n\n                return (\n                  <text\n                    x={xPos}\n                    y={y + height / 2}\n                    fill=\"hsl(var(--foreground))\"\n                    fontSize={13}\n                    fontWeight={500}\n                    dominantBaseline=\"middle\"\n                    textAnchor={textAnchor}\n                  >\n                    {value}\n                  </text>\n                );\n              }}\n            />\n          </Funnel>\n        </RechartsFunnelChart>\n      </ResponsiveContainer>\n    </div>\n  );\n}\n\n// ============================================================================\n// 3. Funnel Chart - Stacked + Legend\n// ============================================================================\n\ninterface FunnelStackedLegendChartProps extends FunnelChartBaseProps {\n  legendPosition?: \"top\" | \"bottom\";\n}\n\nfunction FunnelStackedLegendChart({\n  data,\n  className,\n  showTooltip = true,\n  tooltipIndicator = \"line\",\n  valueFormatter = defaultValueFormatter,\n  legendPosition = \"bottom\",\n}: FunnelStackedLegendChartProps) {\n  const chartData = data.map((item, index) => ({\n    ...item,\n    fill: item.fill || getColor(index),\n  }));\n\n  return (\n    <div className={cn(\"flex flex-col\", className)}>\n      {legendPosition === \"top\" && (\n        <ChartLegend data={chartData} className=\"pb-4\" />\n      )}\n      <div className=\"flex-1 min-h-0\">\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\n          <RechartsFunnelChart>\n            {showTooltip && (\n              <Tooltip\n                content={\n                  <ChartTooltip\n                    indicator={tooltipIndicator}\n                    valueFormatter={valueFormatter}\n                  />\n                }\n                cursor={false}\n              />\n            )}\n            <Funnel\n              data={chartData}\n              dataKey=\"value\"\n              nameKey=\"name\"\n              isAnimationActive={true}\n              animationDuration={800}\n            >\n              {chartData.map((entry, index) => (\n                <Cell key={`cell-${index}`} fill={entry.fill} stroke=\"none\" />\n              ))}\n            </Funnel>\n          </RechartsFunnelChart>\n        </ResponsiveContainer>\n      </div>\n      {legendPosition === \"bottom\" && (\n        <ChartLegend data={chartData} className=\"pt-4\" />\n      )}\n    </div>\n  );\n}\n\n// ============================================================================\n// 4. Funnel Chart - Custom + Label\n// ============================================================================\n\ninterface FunnelCustomLabelChartProps extends FunnelChartBaseProps {\n  strokeWidth?: number;\n  strokeDasharray?: string;\n  showBorder?: boolean;\n}\n\nfunction FunnelCustomLabelChart({\n  data,\n  className,\n  showTooltip = true,\n  tooltipIndicator = \"dashed\",\n  valueFormatter = defaultValueFormatter,\n  strokeWidth = 1,\n  strokeDasharray,\n  showBorder = true,\n}: FunnelCustomLabelChartProps) {\n  const chartData = data.map((item, index) => ({\n    ...item,\n    fill: item.fill || getColor(index),\n  }));\n\n  return (\n    <div className={cn(\"w-full\", className)}>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <RechartsFunnelChart>\n          {showTooltip && (\n            <Tooltip\n              content={\n                <ChartTooltip\n                  indicator={tooltipIndicator}\n                  valueFormatter={valueFormatter}\n                />\n              }\n              cursor={false}\n            />\n          )}\n          <Funnel\n            data={chartData}\n            dataKey=\"value\"\n            nameKey=\"name\"\n            isAnimationActive={true}\n            animationDuration={800}\n          >\n            {chartData.map((entry, index) => (\n              <Cell\n                key={`cell-${index}`}\n                fill={entry.fill}\n                stroke={showBorder ? \"hsl(var(--background))\" : \"none\"}\n                strokeWidth={showBorder ? strokeWidth : 0}\n                strokeDasharray={strokeDasharray}\n              />\n            ))}\n            <LabelList\n              dataKey=\"name\"\n              position=\"center\"\n              fill=\"hsl(var(--background))\"\n              fontSize={12}\n              fontWeight={500}\n            />\n          </Funnel>\n        </RechartsFunnelChart>\n      </ResponsiveContainer>\n    </div>\n  );\n}\n\n// ============================================================================\n// 5. Funnel Chart - Active\n// ============================================================================\n\ninterface FunnelActiveChartProps extends FunnelChartBaseProps {\n  activeIndex?: number;\n  onSegmentClick?: (item: FunnelDataItem, index: number) => void;\n}\n\nfunction FunnelActiveChart({\n  data,\n  className,\n  showTooltip = true,\n  tooltipIndicator = \"dot\",\n  valueFormatter = defaultValueFormatter,\n  activeIndex,\n  onSegmentClick,\n}: FunnelActiveChartProps) {\n  const chartData = data.map((item, index) => ({\n    ...item,\n    fill: item.fill || getColor(index),\n  }));\n\n  return (\n    <div className={cn(\"w-full\", className)}>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <RechartsFunnelChart>\n          {showTooltip && (\n            <Tooltip\n              content={\n                <ChartTooltip\n                  indicator={tooltipIndicator}\n                  valueFormatter={valueFormatter}\n                />\n              }\n              cursor={false}\n            />\n          )}\n          <Funnel\n            data={chartData}\n            dataKey=\"value\"\n            nameKey=\"name\"\n            isAnimationActive={false}\n            onClick={(data) => {\n              const item = data as FunnelDataItem;\n              const idx = chartData.findIndex((d) => d.name === item.name);\n              onSegmentClick?.(item, idx);\n            }}\n            shape={(props: any) => {\n              const index = chartData.findIndex((d) => d.name === props.name);\n              const isActive = activeIndex === index;\n              const isInactive =\n                activeIndex !== undefined && activeIndex !== index;\n\n              return (\n                <Trapezoid\n                  {...props}\n                  fill={props.fill}\n                  stroke={isActive ? \"hsl(var(--foreground))\" : \"transparent\"}\n                  strokeWidth={isActive ? 2 : 0}\n                  strokeDasharray={isActive ? \"6 4\" : undefined}\n                  opacity={isInactive ? 0.3 : 1}\n                  style={{ cursor: \"pointer\" }}\n                />\n              );\n            }}\n          >\n            {chartData.map((entry, index) => (\n              <Cell key={`cell-${index}`} fill={entry.fill} />\n            ))}\n            <LabelList\n              dataKey=\"value\"\n              position=\"right\"\n              fill=\"hsl(var(--foreground))\"\n              fontSize={12}\n              content={(props: any) => {\n                const { x, y, width, height, value, index } = props;\n                const isActive = activeIndex === index;\n                const isInactive =\n                  activeIndex !== undefined && activeIndex !== index;\n\n                return (\n                  <text\n                    x={x + width + 12}\n                    y={y + height / 2}\n                    fill=\"hsl(var(--foreground))\"\n                    fontSize={isActive ? 14 : 12}\n                    fontWeight={isActive ? 600 : 400}\n                    opacity={isInactive ? 0.4 : 1}\n                    dominantBaseline=\"middle\"\n                  >\n                    {valueFormatter(value)}\n                  </text>\n                );\n              }}\n            />\n          </Funnel>\n        </RechartsFunnelChart>\n      </ResponsiveContainer>\n    </div>\n  );\n}\n\n// ============================================================================\n// Exports\n// ============================================================================\n\nexport {\n  FunnelChart,\n  FunnelLabelChart,\n  FunnelStackedLegendChart,\n  FunnelCustomLabelChart,\n  FunnelActiveChart,\n  ChartTooltip,\n  ChartLegend,\n  defaultValueFormatter,\n  NEUTRAL_COLORS,\n};\n",
      "type": "registry:ui",
      "target": "components/ruixen/funnel-chart.tsx"
    }
  ]
}
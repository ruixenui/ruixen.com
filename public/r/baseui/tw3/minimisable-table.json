{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "minimisable-table",
  "type": "registry:ui",
  "title": "Minimisable Table",
  "description": "Glass table with columns that minimize to icon-only width. Spring-animated column manager dropdown. Audio tick on toggle.",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "registry/ruixenui/minimisable-table.tsx",
      "content": "\"use client\";\n\nimport { useState, useRef, useCallback } from \"react\";\nimport { motion } from \"motion/react\";\n\n/**\n * Minimisable Table — Rauno Freiberg craft.\n *\n * Columns can be minimized to icon-only width with spring animation.\n * Glass container. Manage columns via header button.\n * Audio tick on toggle. Smooth width transitions.\n */\n\n/* ── Audio ── */\n\nlet _a: AudioContext | null = null;\nlet _b: AudioBuffer | null = null;\nfunction getCtx(): AudioContext {\n  if (!_a) _a = new (window.AudioContext || (window as unknown as { webkitAudioContext: typeof AudioContext }).webkitAudioContext)();\n  if (_a.state === \"suspended\") _a.resume();\n  return _a;\n}\nfunction getBuf(ac: AudioContext): AudioBuffer {\n  if (_b && _b.sampleRate === ac.sampleRate) return _b;\n  const len = Math.floor(ac.sampleRate * 0.003);\n  const buf = ac.createBuffer(1, len, ac.sampleRate);\n  const ch = buf.getChannelData(0);\n  for (let i = 0; i < len; i++) ch[i] = (Math.random() * 2 - 1) * (1 - i / len) ** 4;\n  _b = buf; return buf;\n}\nfunction tick(ref: React.MutableRefObject<number>) {\n  const now = performance.now();\n  if (now - ref.current < 25) return;\n  ref.current = now;\n  try { const ac = getCtx(); const s = ac.createBufferSource(); const g = ac.createGain(); s.buffer = getBuf(ac); g.gain.value = 0.06; s.connect(g).connect(ac.destination); s.start(); } catch { /* silent */ }\n}\n\n/* ── Types ── */\n\ninterface ColDef<T> {\n  key: string;\n  label: string;\n  icon: string; // SVG path d\n  render?: (item: T) => React.ReactNode;\n}\n\ninterface MinimisableTableProps<T extends Record<string, unknown>> {\n  data?: T[];\n  columns?: ColDef<T>[];\n  defaultMinimized?: string[];\n  sound?: boolean;\n}\n\n/* ── Defaults ── */\n\ntype UserRow = { id: string; name: string; email: string; location: string; status: string; balance: number };\n\nconst DEFAULTS: UserRow[] = [\n  { id: \"1\", name: \"Olivia Martin\", email: \"olivia@example.com\", location: \"New York\", status: \"Active\", balance: 1200 },\n  { id: \"2\", name: \"Jackson Lee\", email: \"jackson@example.com\", location: \"London\", status: \"Active\", balance: 850 },\n  { id: \"3\", name: \"Isabella Nguyen\", email: \"isabella@example.com\", location: \"Paris\", status: \"Inactive\", balance: 320 },\n];\n\n// SVG icon paths (16x16 viewBox)\nconst ICONS = {\n  user: \"M8 8a3 3 0 100-6 3 3 0 000 6zm0 1c-2.67 0-8 1.34-8 4v1h16v-1c0-2.66-5.33-4-8-4z\",\n  mail: \"M2 3h12a1 1 0 011 1v8a1 1 0 01-1 1H2a1 1 0 01-1-1V4a1 1 0 011-1zm0 1l6 4 6-4\",\n  pin: \"M8 1a5 5 0 015 5c0 3.5-5 8-5 8S3 9.5 3 6a5 5 0 015-5zm0 3a2 2 0 100 4 2 2 0 000-4z\",\n  shield: \"M8 1l6 2v4c0 3.31-2.55 6.4-6 7.5C4.55 13.4 2 10.31 2 7V3l6-2z\",\n  dollar: \"M8 1v14M5 4h4.5a2.5 2.5 0 010 5H5m0 0h5.5a2.5 2.5 0 010 5H5\",\n};\n\nconst DEFAULT_COLS: ColDef<UserRow>[] = [\n  { key: \"name\", label: \"Name\", icon: ICONS.user },\n  { key: \"email\", label: \"Email\", icon: ICONS.mail },\n  { key: \"location\", label: \"Location\", icon: ICONS.pin },\n  { key: \"status\", label: \"Status\", icon: ICONS.shield },\n  { key: \"balance\", label: \"Balance\", icon: ICONS.dollar, render: (item) => `$${item.balance.toLocaleString()}` },\n];\n\n/* ── CSS ── */\n\nconst CSS = `.mt{--t-bg:rgba(255,255,255,.72);--t-border:rgba(0,0,0,.06);--t-shadow:0 0 0 .5px rgba(0,0,0,.04),0 2px 4px rgba(0,0,0,.04),0 8px 24px rgba(0,0,0,.06);--t-ink:0,0,0}.dark .mt,[data-theme=\"dark\"] .mt{--t-bg:rgba(30,30,32,.82);--t-border:rgba(255,255,255,.06);--t-shadow:0 0 0 .5px rgba(255,255,255,.04),0 2px 4px rgba(0,0,0,.2),0 8px 24px rgba(0,0,0,.3);--t-ink:255,255,255}.mt-row{transition:background .1s}.mt-row:hover{background:rgba(var(--t-ink),.03)}`;\n\nconst TH: React.CSSProperties = {\n  padding: \"10px 12px\", fontSize: 11, fontWeight: 520,\n  color: \"rgba(var(--t-ink),.4)\", letterSpacing: \"0.04em\",\n  textTransform: \"uppercase\", textAlign: \"left\", whiteSpace: \"nowrap\",\n  borderBottom: \"1px solid var(--t-border)\", cursor: \"pointer\",\n  transition: \"padding .25s, width .25s\",\n};\n\nconst TD: React.CSSProperties = {\n  padding: \"10px 12px\", fontSize: 13, fontWeight: 420,\n  color: \"rgba(var(--t-ink),.7)\",\n  borderBottom: \"1px solid rgba(var(--t-ink),.03)\", whiteSpace: \"nowrap\",\n  overflow: \"hidden\", textOverflow: \"ellipsis\",\n  transition: \"padding .25s, width .25s, max-width .25s\",\n};\n\n/* ── Component ── */\n\nexport function MinimisableTable<T extends Record<string, unknown>>({\n  data = DEFAULTS as unknown as T[],\n  columns = DEFAULT_COLS as unknown as ColDef<T>[],\n  defaultMinimized = [],\n  sound = true,\n}: MinimisableTableProps<T>) {\n  const [minimized, setMinimized] = useState<Set<string>>(new Set(defaultMinimized));\n  const [showMenu, setShowMenu] = useState(false);\n  const lastSound = useRef(0);\n\n  const toggle = useCallback((key: string) => {\n    if (sound) tick(lastSound);\n    setMinimized((prev) => {\n      const next = new Set(prev);\n      if (next.has(key)) next.delete(key); else next.add(key);\n      return next;\n    });\n  }, [sound]);\n\n  return (\n    <div className=\"mt\" style={{\n      width: \"100%\", maxWidth: 700,\n      background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n      boxShadow: \"var(--t-shadow)\", borderRadius: 14,\n      backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n      overflow: \"hidden\",\n    }}>\n      <style dangerouslySetInnerHTML={{ __html: CSS }} />\n\n      {/* Header bar */}\n      <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", padding: \"10px 16px\" }}>\n        <span style={{ fontSize: 13, fontWeight: 560, color: \"rgba(var(--t-ink),.85)\", letterSpacing: \"-0.01em\" }}>\n          Team\n        </span>\n        <div style={{ position: \"relative\" }}>\n          <button\n            onClick={() => setShowMenu(!showMenu)}\n            style={{\n              border: \"none\", background: \"rgba(var(--t-ink),.04)\", padding: \"5px 10px\",\n              borderRadius: 6, fontSize: 11, fontWeight: 500, color: \"rgba(var(--t-ink),.5)\",\n              cursor: \"pointer\", transition: \"background .12s\",\n            }}\n          >\n            Columns\n          </button>\n          {showMenu && (\n            <motion.div\n              initial={{ opacity: 0, y: -4, scale: 0.96 }}\n              animate={{ opacity: 1, y: 0, scale: 1 }}\n              transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\n              style={{\n                position: \"absolute\", right: 0, top: \"calc(100% + 4px)\", zIndex: 10,\n                background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n                boxShadow: \"var(--t-shadow)\", borderRadius: 10, padding: \"6px 0\",\n                minWidth: 140, backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n              }}\n            >\n              {columns.map((col) => (\n                <button\n                  key={col.key}\n                  onClick={() => toggle(col.key)}\n                  style={{\n                    display: \"flex\", alignItems: \"center\", gap: 8, width: \"100%\",\n                    padding: \"6px 12px\", border: \"none\", background: \"none\",\n                    cursor: \"pointer\", fontSize: 12, fontWeight: 450,\n                    color: minimized.has(col.key) ? \"rgba(var(--t-ink),.35)\" : \"rgba(var(--t-ink),.7)\",\n                    textAlign: \"left\",\n                  }}\n                >\n                  <span style={{\n                    width: 14, height: 14, borderRadius: 4,\n                    border: `1.5px solid rgba(var(--t-ink),${minimized.has(col.key) ? \".12\" : \".3\"})`,\n                    display: \"flex\", alignItems: \"center\", justifyContent: \"center\",\n                    fontSize: 10, color: \"rgba(var(--t-ink),.5)\",\n                  }}>\n                    {!minimized.has(col.key) && (\n                      <svg width=\"8\" height=\"8\" viewBox=\"0 0 8 8\"><path d=\"M1.5 4L3 5.5L6.5 2\" stroke=\"currentColor\" strokeWidth=\"1.2\" fill=\"none\" strokeLinecap=\"round\" /></svg>\n                    )}\n                  </span>\n                  {col.label}\n                </button>\n              ))}\n            </motion.div>\n          )}\n        </div>\n      </div>\n\n      {/* Click-away */}\n      {showMenu && <div onClick={() => setShowMenu(false)} style={{ position: \"fixed\", inset: 0, zIndex: 5 }} />}\n\n      <table style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\n        <thead>\n          <tr>\n            {columns.map((col) => {\n              const isMin = minimized.has(col.key);\n              return (\n                <th\n                  key={col.key}\n                  onClick={() => toggle(col.key)}\n                  title={isMin ? `Expand ${col.label}` : `Minimize ${col.label}`}\n                  style={{\n                    ...TH,\n                    width: isMin ? 44 : \"auto\",\n                    maxWidth: isMin ? 44 : undefined,\n                    textAlign: isMin ? \"center\" : \"left\",\n                    padding: isMin ? \"10px 6px\" : TH.padding,\n                  }}\n                >\n                  {isMin ? (\n                    <svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\" style={{ opacity: 0.35 }}>\n                      <path d={col.icon} stroke=\"rgba(var(--t-ink),.5)\" strokeWidth=\"1.2\" fill=\"none\" strokeLinecap=\"round\" />\n                    </svg>\n                  ) : col.label}\n                </th>\n              );\n            })}\n          </tr>\n        </thead>\n        <tbody>\n          {(data as (T & Record<string, unknown>)[]).map((item, i) => (\n            <tr key={String(item.id ?? i)} className=\"mt-row\">\n              {columns.map((col) => {\n                const isMin = minimized.has(col.key);\n                const val = col.render ? col.render(item) : String(item[col.key] ?? \"\");\n                return (\n                  <td\n                    key={col.key}\n                    style={{\n                      ...TD,\n                      width: isMin ? 44 : \"auto\",\n                      maxWidth: isMin ? 44 : 200,\n                      textAlign: isMin ? \"center\" : \"left\",\n                      padding: isMin ? \"10px 6px\" : TD.padding,\n                      fontWeight: col.key === \"name\" ? 500 : TD.fontWeight,\n                      color: col.key === \"name\" ? \"rgba(var(--t-ink),.85)\" : TD.color,\n                    }}\n                  >\n                    {isMin ? (\n                      <svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\" style={{ opacity: 0.2 }}>\n                        <path d={col.icon} stroke=\"rgba(var(--t-ink),.4)\" strokeWidth=\"1.2\" fill=\"none\" strokeLinecap=\"round\" />\n                      </svg>\n                    ) : val}\n                  </td>\n                );\n              })}\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n\nexport default MinimisableTable;\n",
      "type": "registry:ui",
      "target": "components/ruixen/minimisable-table.tsx"
    }
  ]
}
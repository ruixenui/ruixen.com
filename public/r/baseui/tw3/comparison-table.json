{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "comparison-table",
  "type": "registry:ui",
  "title": "Comparison Table",
  "description": "Glass table with category filter pills, select up to 2 items for side-by-side comparison. Spring-animated comparison panel with winner highlighting.",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "registry/ruixenui/comparison-table.tsx",
      "content": "\"use client\";\n\nimport { useState, useRef, useCallback, useMemo } from \"react\";\nimport { motion, AnimatePresence } from \"motion/react\";\n\n/**\n * Comparison Table — Rauno Freiberg craft.\n *\n * Glass container. Select up to 2 items for side-by-side comparison.\n * Category filter pills with spring-sliding indicator.\n * Comparison panel springs in from below. Winner values highlighted.\n * Audio tick on selection.\n */\n\n/* ── Audio ── */\n\nlet _a: AudioContext | null = null;\nlet _b: AudioBuffer | null = null;\nfunction getCtx(): AudioContext {\n  if (!_a) _a = new (window.AudioContext || (window as unknown as { webkitAudioContext: typeof AudioContext }).webkitAudioContext)();\n  if (_a.state === \"suspended\") _a.resume();\n  return _a;\n}\nfunction getBuf(ac: AudioContext): AudioBuffer {\n  if (_b && _b.sampleRate === ac.sampleRate) return _b;\n  const len = Math.floor(ac.sampleRate * 0.003);\n  const buf = ac.createBuffer(1, len, ac.sampleRate);\n  const ch = buf.getChannelData(0);\n  for (let i = 0; i < len; i++) ch[i] = (Math.random() * 2 - 1) * (1 - i / len) ** 4;\n  _b = buf; return buf;\n}\nfunction tick(ref: React.MutableRefObject<number>) {\n  const now = performance.now();\n  if (now - ref.current < 25) return;\n  ref.current = now;\n  try { const ac = getCtx(); const s = ac.createBufferSource(); const g = ac.createGain(); s.buffer = getBuf(ac); g.gain.value = 0.06; s.connect(g).connect(ac.destination); s.start(); } catch { /* silent */ }\n}\n\n/* ── Types ── */\n\nexport interface ComparisonItem {\n  id: number;\n  category: string;\n  price: number;\n  rating: number;\n  stock: number;\n}\n\ninterface ComparisonTableProps {\n  data?: ComparisonItem[];\n  categories?: string[];\n  sound?: boolean;\n}\n\n/* ── Defaults ── */\n\nconst DEFAULTS: ComparisonItem[] = [\n  { id: 1, category: \"Laptop\", price: 1200, rating: 4.5, stock: 20 },\n  { id: 2, category: \"Tablet\", price: 600, rating: 4.1, stock: 35 },\n  { id: 3, category: \"Smartphone\", price: 800, rating: 4.7, stock: 50 },\n  { id: 4, category: \"Monitor\", price: 300, rating: 4.0, stock: 15 },\n  { id: 5, category: \"Laptop\", price: 1500, rating: 4.8, stock: 10 },\n  { id: 6, category: \"Tablet\", price: 550, rating: 4.2, stock: 28 },\n];\n\nconst DEFAULT_CATS = [\"All\", \"Laptop\", \"Tablet\", \"Smartphone\", \"Monitor\"];\n\n/* ── CSS ── */\n\nconst CSS = `.ct{--t-bg:rgba(255,255,255,.72);--t-border:rgba(0,0,0,.06);--t-shadow:0 0 0 .5px rgba(0,0,0,.04),0 2px 4px rgba(0,0,0,.04),0 8px 24px rgba(0,0,0,.06);--t-ink:0,0,0;--t-ok:#34C759;--t-hi:rgba(0,0,0,.88);--t-sel:rgba(0,122,255,.08)}.dark .ct,[data-theme=\"dark\"] .ct{--t-bg:rgba(30,30,32,.82);--t-border:rgba(255,255,255,.06);--t-shadow:0 0 0 .5px rgba(255,255,255,.04),0 2px 4px rgba(0,0,0,.2),0 8px 24px rgba(0,0,0,.3);--t-ink:255,255,255;--t-ok:#30D158;--t-hi:rgba(255,255,255,.88);--t-sel:rgba(100,210,255,.08)}.ct-row{transition:background .1s}.ct-row:hover{background:rgba(var(--t-ink),.03)}`;\n\nconst TH: React.CSSProperties = {\n  padding: \"10px 16px\", fontSize: 11, fontWeight: 520,\n  color: \"rgba(var(--t-ink),.4)\", letterSpacing: \"0.04em\",\n  textTransform: \"uppercase\", textAlign: \"left\", whiteSpace: \"nowrap\",\n  borderBottom: \"1px solid var(--t-border)\",\n};\n\nconst TD: React.CSSProperties = {\n  padding: \"10px 16px\", fontSize: 13, fontWeight: 420,\n  color: \"rgba(var(--t-ink),.7)\",\n  borderBottom: \"1px solid rgba(var(--t-ink),.03)\", whiteSpace: \"nowrap\",\n};\n\n/* ── Component ── */\n\nexport function ComparisonTable({\n  data = DEFAULTS,\n  categories = DEFAULT_CATS,\n  sound = true,\n}: ComparisonTableProps) {\n  const [selected, setSelected] = useState<number[]>([]);\n  const [activeCategory, setActiveCategory] = useState(\"All\");\n  const lastSound = useRef(0);\n\n  const toggleSelect = useCallback((id: number) => {\n    if (sound) tick(lastSound);\n    setSelected((prev) =>\n      prev.includes(id) ? prev.filter((x) => x !== id) : prev.length < 2 ? [...prev, id] : prev,\n    );\n  }, [sound]);\n\n  const filtered = useMemo(() => {\n    if (activeCategory === \"All\") return data;\n    return data.filter((d) => d.category === activeCategory);\n  }, [data, activeCategory]);\n\n  const compared = useMemo(() => data.filter((d) => selected.includes(d.id)), [data, selected]);\n\n  const attrs: { key: keyof ComparisonItem; label: string; better: \"higher\" | \"lower\" }[] = [\n    { key: \"price\", label: \"Price\", better: \"lower\" },\n    { key: \"rating\", label: \"Rating\", better: \"higher\" },\n    { key: \"stock\", label: \"Stock\", better: \"higher\" },\n  ];\n\n  return (\n    <div className=\"ct\" style={{\n      width: \"100%\", maxWidth: 640,\n      background: \"var(--t-bg)\", border: \"1px solid var(--t-border)\",\n      boxShadow: \"var(--t-shadow)\", borderRadius: 14,\n      backdropFilter: \"blur(16px)\", WebkitBackdropFilter: \"blur(16px)\",\n      overflow: \"hidden\",\n    }}>\n      <style dangerouslySetInnerHTML={{ __html: CSS }} />\n\n      {/* Header */}\n      <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", padding: \"12px 16px 0\" }}>\n        <span style={{ fontSize: 13, fontWeight: 560, color: \"rgba(var(--t-ink),.85)\", letterSpacing: \"-0.01em\" }}>\n          Compare Products\n        </span>\n        {selected.length > 0 && (\n          <button\n            onClick={() => { setSelected([]); if (sound) tick(lastSound); }}\n            style={{\n              border: \"none\", background: \"rgba(var(--t-ink),.04)\", padding: \"4px 10px\",\n              borderRadius: 6, fontSize: 11, fontWeight: 500, color: \"rgba(var(--t-ink),.5)\",\n              cursor: \"pointer\",\n            }}\n          >\n            Reset\n          </button>\n        )}\n      </div>\n\n      {/* Category pills */}\n      <div style={{ display: \"flex\", gap: 4, padding: \"10px 16px\", position: \"relative\" }}>\n        {categories.map((cat) => (\n          <button\n            key={cat}\n            onClick={() => { setActiveCategory(cat); if (sound) tick(lastSound); }}\n            style={{\n              position: \"relative\", border: \"none\", background: \"none\", padding: \"5px 12px\",\n              borderRadius: 6, fontSize: 11, fontWeight: 500, cursor: \"pointer\", zIndex: 1,\n              color: activeCategory === cat ? \"var(--t-hi)\" : \"rgba(var(--t-ink),.4)\",\n              transition: \"color .15s\",\n            }}\n          >\n            {activeCategory === cat && (\n              <motion.div\n                layoutId=\"ct-pill\"\n                style={{\n                  position: \"absolute\", inset: 0, borderRadius: 6,\n                  background: \"rgba(var(--t-ink),.06)\",\n                }}\n                transition={{ type: \"spring\", stiffness: 500, damping: 35 }}\n              />\n            )}\n            <span style={{ position: \"relative\", zIndex: 1 }}>{cat}</span>\n          </button>\n        ))}\n      </div>\n\n      {/* Table */}\n      <table style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\n        <thead>\n          <tr>\n            <th style={TH}>Category</th>\n            <th style={TH}>Price</th>\n            <th style={TH}>Rating</th>\n            <th style={TH}>Stock</th>\n            <th style={{ ...TH, textAlign: \"center\", width: 60 }}>Select</th>\n          </tr>\n        </thead>\n        <tbody>\n          <AnimatePresence mode=\"popLayout\">\n            {filtered.map((item) => {\n              const isSel = selected.includes(item.id);\n              return (\n                <motion.tr\n                  key={item.id}\n                  layout\n                  initial={{ opacity: 0, y: -8 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, y: -8 }}\n                  transition={{ type: \"spring\", stiffness: 400, damping: 30 }}\n                  className=\"ct-row\"\n                  style={{ background: isSel ? \"var(--t-sel)\" : undefined, cursor: \"pointer\" }}\n                  onClick={() => toggleSelect(item.id)}\n                >\n                  <td style={{ ...TD, fontWeight: 500, color: \"rgba(var(--t-ink),.85)\" }}>{item.category}</td>\n                  <td style={{ ...TD, fontVariantNumeric: \"tabular-nums\" }}>${item.price.toLocaleString()}</td>\n                  <td style={{ ...TD, fontVariantNumeric: \"tabular-nums\" }}>{item.rating}</td>\n                  <td style={{ ...TD, fontVariantNumeric: \"tabular-nums\" }}>{item.stock}</td>\n                  <td style={{ ...TD, textAlign: \"center\" }}>\n                    <span style={{\n                      display: \"inline-flex\", width: 18, height: 18, borderRadius: 5,\n                      border: `1.5px solid rgba(var(--t-ink),${isSel ? \".5\" : \".15\"})`,\n                      background: isSel ? \"rgba(var(--t-ink),.08)\" : \"none\",\n                      alignItems: \"center\", justifyContent: \"center\",\n                    }}>\n                      {isSel && (\n                        <svg width=\"10\" height=\"10\" viewBox=\"0 0 10 10\">\n                          <path d=\"M2 5L4 7L8 3\" stroke=\"rgba(var(--t-ink),.6)\" strokeWidth=\"1.4\" fill=\"none\" strokeLinecap=\"round\" />\n                        </svg>\n                      )}\n                    </span>\n                  </td>\n                </motion.tr>\n              );\n            })}\n          </AnimatePresence>\n        </tbody>\n      </table>\n\n      {/* Comparison panel */}\n      <AnimatePresence>\n        {compared.length === 2 && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: \"auto\", opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            transition={{ type: \"spring\", stiffness: 400, damping: 30 }}\n            style={{ overflow: \"hidden\" }}\n          >\n            <div style={{ borderTop: \"1px solid var(--t-border)\", padding: \"14px 16px\" }}>\n              <div style={{ fontSize: 12, fontWeight: 520, color: \"rgba(var(--t-ink),.5)\", marginBottom: 10, textTransform: \"uppercase\", letterSpacing: \"0.04em\" }}>\n                Comparison\n              </div>\n              <div style={{ display: \"grid\", gridTemplateColumns: \"1fr 1fr 1fr\", gap: \"8px 16px\" }}>\n                <div style={{ fontSize: 11, fontWeight: 500, color: \"rgba(var(--t-ink),.35)\" }}>Attribute</div>\n                <div style={{ fontSize: 11, fontWeight: 500, color: \"rgba(var(--t-ink),.5)\" }}>{compared[0].category} #{compared[0].id}</div>\n                <div style={{ fontSize: 11, fontWeight: 500, color: \"rgba(var(--t-ink),.5)\" }}>{compared[1].category} #{compared[1].id}</div>\n                {attrs.map((attr) => {\n                  const v0 = compared[0][attr.key] as number;\n                  const v1 = compared[1][attr.key] as number;\n                  const w0 = attr.better === \"higher\" ? v0 > v1 : v0 < v1;\n                  const w1 = attr.better === \"higher\" ? v1 > v0 : v1 < v0;\n                  return [\n                    <div key={`${attr.key}-label`} style={{ fontSize: 12, color: \"rgba(var(--t-ink),.5)\" }}>{attr.label}</div>,\n                    <motion.div\n                      key={`${attr.key}-0`}\n                      initial={{ scale: 0.95, opacity: 0 }}\n                      animate={{ scale: 1, opacity: 1 }}\n                      transition={{ type: \"spring\", stiffness: 400, damping: 28, delay: 0.05 }}\n                      style={{\n                        fontSize: 13, fontWeight: w0 ? 560 : 420,\n                        color: w0 ? \"var(--t-ok)\" : \"rgba(var(--t-ink),.5)\",\n                        fontVariantNumeric: \"tabular-nums\",\n                      }}\n                    >\n                      {attr.key === \"price\" ? `$${v0.toLocaleString()}` : v0}\n                    </motion.div>,\n                    <motion.div\n                      key={`${attr.key}-1`}\n                      initial={{ scale: 0.95, opacity: 0 }}\n                      animate={{ scale: 1, opacity: 1 }}\n                      transition={{ type: \"spring\", stiffness: 400, damping: 28, delay: 0.1 }}\n                      style={{\n                        fontSize: 13, fontWeight: w1 ? 560 : 420,\n                        color: w1 ? \"var(--t-ok)\" : \"rgba(var(--t-ink),.5)\",\n                        fontVariantNumeric: \"tabular-nums\",\n                      }}\n                    >\n                      {attr.key === \"price\" ? `$${v1.toLocaleString()}` : v1}\n                    </motion.div>,\n                  ];\n                })}\n              </div>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Footer */}\n      <div style={{\n        display: \"flex\", justifyContent: \"space-between\", padding: \"10px 16px\",\n        borderTop: \"1px solid var(--t-border)\",\n      }}>\n        <span style={{ fontSize: 11, fontWeight: 450, color: \"rgba(var(--t-ink),.35)\" }}>\n          {filtered.length} items\n        </span>\n        <span style={{ fontSize: 11, fontWeight: 450, color: \"rgba(var(--t-ink),.35)\" }}>\n          {selected.length}/2 selected\n        </span>\n      </div>\n    </div>\n  );\n}\n\nexport default ComparisonTable;\n",
      "type": "registry:ui",
      "target": "components/ruixen/comparison-table.tsx"
    }
  ]
}